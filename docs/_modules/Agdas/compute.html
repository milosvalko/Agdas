<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Agdas.compute &mdash; Agdas 1.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Agdas
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Agdas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">Agdas.compute</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for Agdas.compute</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">urllib.request</span><span class="o">,</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">uic</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QLabel</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span><span class="p">,</span> <span class="n">time</span>
<span class="c1"># from warning import Warning</span>
<span class="c1"># from classes import Fall, projectFile, rawFile, dropFile, matr_db, res_final, Graph, Compare_gsoft_agdas</span>
<span class="c1"># from CONFIG import getFG5X, getFG5, matrDatabase, statistic, separator, headers, logo_picture, round_line_ind, \</span>
<span class="c1">#     warning_window, tau, languages</span>
<span class="kn">import</span> <span class="nn">sqlite3</span> <span class="k">as</span> <span class="nn">sql</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span> <span class="kn">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QPixmap</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">floor</span>
<span class="c1"># from functions import allan, roundList, date_to_mjd, rssq, movingAverage, mjd_to_jd, jd_to_date, get_date_last_version, \</span>
<span class="c1">#     write_last_version</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">sig</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">configparser</span>
<span class="kn">from</span> <span class="nn">winotify</span> <span class="kn">import</span> <span class="n">Notification</span><span class="p">,</span> <span class="n">audio</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Mm</span><span class="p">,</span> <span class="n">Pt</span>

<span class="c1"># from astropy.stats import sigma_clip, mad_std</span>

<span class="n">script_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

<span class="n">PATH</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">uic</span><span class="o">.</span><span class="n">loadUiType</span><span class="p">(</span><span class="n">script_path</span> <span class="o">+</span> <span class="s1">&#39;\gui\compute.ui&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="Compute"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute">[docs]</a><span class="k">class</span> <span class="nc">Compute</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">PATH</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class serves for the main run of Agdas. Drops measuring is processed, statistics are computed and outputs are generated - graphs and files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stationData</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">instrumentData</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">processingResults</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
                 <span class="n">gravityCorrections</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">header2</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">rawlines</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                 <span class="n">header1</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">projDirPath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">setFile</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path: str</span>
<span class="sd">            path to source data</span>
<span class="sd">        stationData: dict</span>
<span class="sd">            data from project file</span>
<span class="sd">        instrumentData: dict</span>
<span class="sd">            data from project file</span>
<span class="sd">        processingResults: dict</span>
<span class="sd">            data from project file</span>
<span class="sd">        gravityCorrections: dict</span>
<span class="sd">            data from project file</span>
<span class="sd">        header2: str</span>
<span class="sd">            names of columns in Raw file</span>
<span class="sd">        rawlines: list</span>
<span class="sd">            measuring from Raw file</span>
<span class="sd">        header1: str</span>
<span class="sd">            first line from Raw file, with number of sets, drops...</span>
<span class="sd">        projDirPath: str</span>
<span class="sd">            output folder</span>
<span class="sd">        setFile: str</span>
<span class="sd">            path to set file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QIcon</span><span class="p">(</span><span class="n">logo_picture</span><span class="p">))</span>

        <span class="c1"># make class values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span> <span class="o">=</span> <span class="n">stationData</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span> <span class="o">=</span> <span class="n">instrumentData</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span> <span class="o">=</span> <span class="n">processingResults</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gravityCorrections</span> <span class="o">=</span> <span class="n">gravityCorrections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_rawfile</span> <span class="o">=</span> <span class="n">header2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span> <span class="o">=</span> <span class="n">rawlines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header1</span> <span class="o">=</span> <span class="n">header1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">=</span> <span class="n">projDirPath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFile</span> <span class="o">=</span> <span class="n">setFile</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ndrops</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kalpha</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drop</span><span class="p">()</span>  <span class="c1"># open and load drop file</span>

        <span class="c1"># set values to widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s1">&#39;FG5X&#39;</span><span class="p">,</span> <span class="s1">&#39;FG5&#39;</span><span class="p">])</span>

        <span class="c1"># setting sel.ps value</span>
        <span class="n">multiplex</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])</span>
        <span class="n">scalefactor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">multiplex</span> <span class="o">*</span> <span class="n">scalefactor</span> <span class="o">==</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPrescale</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">multiplex</span> <span class="o">*</span> <span class="n">scalefactor</span> <span class="o">==</span> <span class="mi">800</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPrescale</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">multiplex</span> <span class="o">*</span> <span class="n">scalefactor</span> <span class="o">==</span> <span class="mi">100</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPrescale</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setPrescale</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">automatic_detection_gravimeter</span><span class="p">()</span>

        <span class="c1"># connect buttons with method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter_box</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_gravimeter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter_combox</span><span class="o">.</span><span class="n">currentTextChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDelimiter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Run</span><span class="p">)</span>
        <span class="c1"># self.run.clicked.connect(self.Run_batch)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allDrop</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numDrops</span><span class="p">)</span>
        <span class="c1"># self.downloadPoleCorr.clicked.connect(self.downloadPole)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DisStat</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">split_set</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disabledSplit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentSet</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kalpha</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_tool_tip</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_gravimeter</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_tool_tip</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frminT</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_frmin_t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frmaxT</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">set_frmax_t</span><span class="p">)</span>
        <span class="c1"># self.fill_output_language()</span>

        <span class="c1"># self.Prescale()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numDrops</span><span class="p">()</span>

        <span class="c1"># set l cable to ui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcable_ar</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;Lcable&#39;</span><span class="p">]))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">total_fringe</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">]))</span>

        <span class="c1"># self.setMouseTracking(True)</span>

        <span class="c1"># self.service.addItem(&#39;Naval Observatory&#39;)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exec</span><span class="p">()</span>

<div class="viewcode-block" id="Compute.set_rejsgima"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_rejsgima">[docs]</a>    <span class="k">def</span> <span class="nf">set_rejsgima</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rejsig</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rejsigma</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span></div>

    <span class="c1"># def set_setup_height_ui(self):</span>
    <span class="c1">#</span>
    <span class="c1">#     self.set_height.setText(self.stationData[&#39;setupHeight&#39;])</span>

<div class="viewcode-block" id="Compute.set_fubi_freq_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_fubi_freq_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_fubi_freq_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rub_freq</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;rubiFreq&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Compute.set_nforfft"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_nforfft">[docs]</a>    <span class="k">def</span> <span class="nf">set_nforfft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute n for fft and it as self.nforfft.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Compute.set_tool_tip"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_tool_tip">[docs]</a>    <span class="k">def</span> <span class="nf">set_tool_tip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set tooltips for widgets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_3</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Coverage factor for drop acceptance in set. Drop is accepted if σ(</span><span class="si">{}</span><span class="s1">) * set_std &gt; abs(avr_gtopcor_by_set - drop_gtopcor)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rejsigma</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_7</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="s1">&#39;Limit for rms of residuals. Drop is accepted if m0_drop &lt; 1</span><span class="si">{}</span><span class="s1"> % median_m0_all_drops&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kalpha</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complete_out</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Check Complete outputs only for more than 3 sets and more than 10 drops in set&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_15</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span>
            <span class="s2">&quot;Cut-off frequency for low-pass filtering of residuals in graphs. It doesn&#39;t influence the processing.&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.set_graph_language"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_graph_language">[docs]</a>    <span class="k">def</span> <span class="nf">set_graph_language</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read ini files from &quot;graphs_languages&quot; and save it to graph_lang as dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># # find shortcut of language, &quot;languages&quot; is imported from functions.py</span>
        <span class="c1"># for i in languages:</span>
        <span class="c1">#     if languages[i] == lang:</span>
        <span class="c1">#         lang_sh = i</span>

        <span class="n">lang_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="s1">&#39;graphs_languages&#39;</span><span class="p">,</span> <span class="s1">&#39;graphs_description_EN-GB.ini&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filenames</span><span class="o">=</span><span class="n">lang_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.set_lcable_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_lcable_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_lcable_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set L cable lenght from GUI - lcable_ar</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lcable</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lcable_ar</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span></div>

<div class="viewcode-block" id="Compute.automatic_detection_gravimeter"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.automatic_detection_gravimeter">[docs]</a>    <span class="k">def</span> <span class="nf">automatic_detection_gravimeter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set gravimeter automatically by number of processed fringes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">1e6</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter_box</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter_box</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.set_sensitivity_intervals"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_sensitivity_intervals">[docs]</a>    <span class="k">def</span> <span class="nf">set_sensitivity_intervals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method sets intervals for computing of sensitivity. This is change against solution with prescale</span>
<span class="sd">        factor. This solution is based only on frmin, frmax and total number of fringes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 10 percent from &quot;Total Fringes Acquired&quot;</span>
        <span class="n">INTsens</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sens_tn</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Sensitivity top - minimum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sens_tx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="n">INTsens</span>  <span class="c1"># Sensitivity top - maximum</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="n">INTsens</span>  <span class="c1"># Sensitivity bottom - minimum</span>

        <span class="c1"># Sensitivity bottom - maximum</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">+</span> <span class="n">INTsens</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">+</span> <span class="n">INTsens</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sensa_tn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># Sensitivity top - minimum (for rms computing)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensa_tx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># Sensitivity top - maximum (for rms computing)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sensa_bn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span> <span class="o">*</span> <span class="mf">0.03</span><span class="p">)</span>  <span class="c1"># Sensitivity bottom - minimum (for rms computing)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sensa_bx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">)</span>  <span class="c1"># Sensitivity bottom - maximum (for rms computing)</span></div>

<div class="viewcode-block" id="Compute.set_frmaxplot"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_frmaxplot">[docs]</a>    <span class="k">def</span> <span class="nf">set_frmaxplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set frmaxplot - max range for graphs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.frmaxplot = self.gravimeter[&#39;frmaxplot&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">+</span> <span class="mi">10</span></div>

<div class="viewcode-block" id="Compute.set_total_fringes"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_total_fringes">[docs]</a>    <span class="k">def</span> <span class="nf">set_total_fringes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set number of fringes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Compute.set_frmin_frmax"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_frmin_frmax">[docs]</a>    <span class="k">def</span> <span class="nf">set_frmin_frmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set frmin - first fringe and frmax - last fringe. Loaded from GUI - frminT, frmaxT.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frminT</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxT</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span></div>

<div class="viewcode-block" id="Compute.set_multiplex_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_multiplex_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_multiplex_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set Multiplex from Project file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiplex</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Compute.set_scalefactor_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_scalefactor_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_scalefactor_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set Scale factor from Project file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scaleFactor</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Compute.set_prescale_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_prescale_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_prescale_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set Prescale to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preScale</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])))</span></div>

<div class="viewcode-block" id="Compute.set_frminT_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_frminT_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_frminT_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set frmin to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frminT</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;frmin&#39;</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Compute.set_frmaxT_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_frmaxT_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_frmaxT_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set frmax to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frmaxT</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;frmax&#39;</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Compute.set_gradient_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_gradient_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_gradient_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set gradient to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Compute.set_modulation_frequency_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_modulation_frequency_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_modulation_frequency_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set modulation frequency to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmodf</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;fmodf&#39;</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Compute.set_lpar_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_lpar_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_lpar_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set length of L cable to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lpar</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;Lpar&#39;</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Compute.set_pole_corr_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_pole_corr_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_pole_corr_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set polar correction to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poleCorr_file</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravityCorrections</span><span class="p">[</span><span class="s1">&#39;polarMotion&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Compute.set_ui"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_ui">[docs]</a>    <span class="k">def</span> <span class="nf">set_ui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setup values to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_multiplex_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_scalefactor_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_prescale_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_frminT_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_frmaxT_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_gradient_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_modulation_frequency_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_lpar_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_pole_corr_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_frmin_t</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_frmax_t</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_fubi_freq_ui</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_height</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;setupHeight&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="Compute.set_frmin_t"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_frmin_t">[docs]</a>    <span class="k">def</span> <span class="nf">set_frmin_t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set time of first fringe to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">frmin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frminT</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">frmin</span> <span class="o">=</span> <span class="mi">1000000</span>

        <span class="k">if</span> <span class="n">frmin</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">frmin</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">]):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span> <span class="o">+</span> <span class="n">frmin</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frminT_t</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1"> s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frminT_t</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.set_frmax_t"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_frmax_t">[docs]</a>    <span class="k">def</span> <span class="nf">set_frmax_t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set time of first fringe to GUI.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">frmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxT</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">frmax</span> <span class="o">=</span> <span class="mi">1000000</span>

        <span class="k">if</span> <span class="n">frmax</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">frmax</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">]):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span> <span class="o">+</span> <span class="n">frmax</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frmaxT_t</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1"> s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frmaxT_t</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.set_gravimeter"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_gravimeter">[docs]</a>    <span class="k">def</span> <span class="nf">set_gravimeter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set gravimeter and rewrite ui.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">grav</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">grav</span> <span class="o">==</span> <span class="s1">&#39;FG5X&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span> <span class="o">=</span> <span class="n">getFG5X</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">grav</span> <span class="o">==</span> <span class="s1">&#39;FG5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span> <span class="o">=</span> <span class="n">getFG5</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_ui</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.setPrescale"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.setPrescale">[docs]</a>    <span class="k">def</span> <span class="nf">setPrescale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set prescale.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span> <span class="o">=</span> <span class="n">ps</span></div>

<div class="viewcode-block" id="Compute.setDelimiter"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.setDelimiter">[docs]</a>    <span class="k">def</span> <span class="nf">setDelimiter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set delimiter for printing text files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter_combox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.currentSet"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.currentSet">[docs]</a>    <span class="k">def</span> <span class="nf">currentSet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show number of drops in sets, when split on sets is giving by the user.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">/</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sets_view</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Compute.disabledSplit"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.disabledSplit">[docs]</a>    <span class="k">def</span> <span class="nf">disabledSplit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change QComboBox Enabled/Disabled by click on the checkbox.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">isEnabled</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.DisStat"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.DisStat">[docs]</a>    <span class="k">def</span> <span class="nf">DisStat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method set possible choice of sets to QComboBox.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">x</span><span class="p">:</span>
                <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">d</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.numDrops"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.numDrops">[docs]</a>    <span class="k">def</span> <span class="nf">numDrops</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set all drops for computing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">allDrop</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndrops</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">check</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrops</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">check</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">setDisabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.downloadPole"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.downloadPole">[docs]</a>    <span class="k">def</span> <span class="nf">downloadPole</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Download pole coordinates from IERS/Naval observatory and compute polar correction for each drop.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;IERS&#39;</span><span class="p">:</span>

            <span class="c1"># finals_path = os.getcwd() + &#39;/finals/finals2000A_iers.all.csv&#39;</span>
            <span class="n">finals_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="s1">&#39;finals&#39;</span><span class="p">,</span> <span class="s1">&#39;finals2000A_iers.all.csv&#39;</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://datacenter.iers.org/data/csv/finals2000A.all.csv&#39;</span>

            <span class="k">if</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">finals_path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">604800</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">finals_path</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">:</span>
                    <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">warning_window</span><span class="p">[</span><span class="s1">&#39;internet&#39;</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Naval Observatory&#39;</span><span class="p">:</span>

            <span class="c1"># finals_path = os.getcwd() + &#39;/finals/finals2000A_naval.all.csv&#39;</span>
            <span class="n">finals_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="s1">&#39;finals&#39;</span><span class="p">,</span> <span class="s1">&#39;finals2000A_naval.all.csv&#39;</span><span class="p">)</span>
            <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://maia.usno.navy.mil/ser7/finals.daily.extended&#39;</span>

            <span class="k">if</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">finals_path</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">604800</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">finals_path</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">:</span>
                    <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">warning_window</span><span class="p">[</span><span class="s1">&#39;internet&#39;</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>

        <span class="c1"># coordinations of point</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;long&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
        <span class="n">deg</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># degree of fitting</span>

        <span class="c1"># date of first and last drop in campaign</span>
        <span class="n">first_drop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">last_drop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">first_drop_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">first_drop</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">first_drop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">last_drop_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">last_drop</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">last_drop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">date</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">first_drop_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">date1</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">last_drop_date</span><span class="o">.</span><span class="n">date</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

        <span class="n">count_days</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">last_drop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">first_drop</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;IERS&#39;</span><span class="p">:</span>
            <span class="c1"># open and load file from IERS</span>
            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">finals_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polar_file_date</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">finals_path</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="c1"># find index of starting day</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="n">date</span><span class="p">:</span>
                    <span class="c1"># today = row</span>
                    <span class="k">break</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># get one day before and one day after measuring</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">3</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">count_days</span><span class="p">]</span>
            <span class="n">x_pole</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>
            <span class="n">y_pole</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_pole</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">24</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Naval Observatory&#39;</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">finals_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polar_file_date</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">finals_path</span><span class="p">)</span>
            <span class="n">file_l</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">file</span> <span class="o">=</span> <span class="n">file_l</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
                <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;20&#39;</span> <span class="o">+</span> <span class="n">l</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">l</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="n">date</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># get one day before and one day after measuring</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">3</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">count_days</span><span class="p">]</span>
            <span class="n">x_pole</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>
            <span class="n">y_pole</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_pole</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">24</span><span class="p">)</span>

        <span class="c1"># fit pole coordinates</span>
        <span class="n">x_para</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x_pole</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>
        <span class="n">y_para</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_pole</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_pole_interp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_pole_interp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">)):</span>
            <span class="n">split_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">drop_date</span> <span class="o">=</span> \
                <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">split_line</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">split_line</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">day_drop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">drop_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">multi</span> <span class="o">=</span> <span class="n">day_drop</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>

            <span class="n">drop_time</span> <span class="o">=</span> <span class="n">split_line</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">drop_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">drop_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">drop_time</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">drop_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">24</span> <span class="o">+</span> <span class="n">multi</span> <span class="o">*</span> <span class="mi">24</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">x_pole_interp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">x_para</span><span class="p">,</span> <span class="n">drop_time</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_pole_interp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">y_para</span><span class="p">,</span> <span class="n">drop_time</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">19.139</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">fi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">x_pole_interp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lam</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_pole_interp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lam</span><span class="p">)))</span></div>

        <span class="c1"># self.poleCorrIERS.setText(&#39;&lt;{:.2f}; {:.2f}&gt;&#39;.format(min(self.dg), max(self.dg)))</span>

<div class="viewcode-block" id="Compute.defineSets"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.defineSets">[docs]</a>    <span class="k">def</span> <span class="nf">defineSets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate user defined split to sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">drops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="nb">set</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="c1"># self.nset = set</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="n">drops</span> <span class="o">/</span> <span class="nb">set</span><span class="p">)</span>

        <span class="n">drop1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">drop_in_set</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">set</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drop_in_set</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">drop1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">set</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">drops</span> <span class="o">%</span> <span class="n">p</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drop_in_set</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">drops</span> <span class="o">-</span> <span class="nb">set</span> <span class="o">*</span> <span class="n">p</span><span class="p">)])</span></div>

<div class="viewcode-block" id="Compute.drop"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.drop">[docs]</a>    <span class="k">def</span> <span class="nf">drop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open and read drop file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">dropfile</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;\*.drop.txt&#39;</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">dropFile</span><span class="p">(</span><span class="n">dropfile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">columns_dropfile</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">dropHeader4</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">dropLines</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.Run"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.Run">[docs]</a>    <span class="k">def</span> <span class="nf">Run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In this method is managed the whole calculating.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># set color of text - i am stil running</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_time</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;color: black; font-size: 10pt&#39;</span><span class="p">)</span>
        <span class="c1"># set color of RUN button on green</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color : green&quot;</span><span class="p">)</span>
        <span class="c1"># delete information about time of calculating from last computing</span>
        <span class="c1"># self.calc_time.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_time</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;I am still running!&#39;</span><span class="p">)</span>

        <span class="c1"># Languages to output_languages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_graph_language</span><span class="p">()</span>

        <span class="c1"># set l cable from ui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_lcable_ui</span><span class="p">()</span>


        <span class="c1"># set count of all fringes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_total_fringes</span><span class="p">()</span>

        <span class="c1"># Set self.frmin and self.frmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_frmin_frmax</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmaxT_t</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;out&#39;</span><span class="p">:</span>
            <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="s1">&#39;Frmax out of range!&#39;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_frmaxplot</span><span class="p">()</span>

        <span class="c1"># Set sensitivity intervals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_sensitivity_intervals</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_rejsgima</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rubi_freq</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rub_freq</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>

        <span class="c1"># clear the logging window?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clwin</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># define user sets</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_set</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">defineSets</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">warning_window</span><span class="p">[</span><span class="s1">&#39;split_set&#39;</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color :#f0f0f0;&quot;</span><span class="p">)</span>
                <span class="k">return</span>

        <span class="c1"># download polar coordinates and compute polar corrections if correction from web is required</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">useIERSPoleCorr</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">downloadPole</span><span class="p">()</span>

        <span class="c1"># count of the fringes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># load kalpha</span>
        <span class="n">kalpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kalpha</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>

        <span class="n">frminss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;frminss&#39;</span><span class="p">]</span>
        <span class="c1"># self.frmaxss = self.gravimeter[&#39;frmaxss&#39;]</span>

        <span class="c1"># create estim file with head</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">estim</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;estim&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                              <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;estim&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="n">estim_grad</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;estim_grad&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                                   <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;estimgrad&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="c1"># create database for save every measuring</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span> <span class="o">=</span> <span class="n">matr_db</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/data.db&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">sql</span><span class="o">.</span><span class="n">OperationalError</span><span class="p">:</span>
            <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">warning_window</span><span class="p">[</span><span class="s1">&#39;locked_database&#39;</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>

        <span class="c1"># measuring time of run computing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="c1"># count of the drops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">numDrop</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_set</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sets_choose</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;setsCollected&#39;</span><span class="p">])</span>

        <span class="n">files</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">atm</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># atmospheric correction data</span>
        <span class="n">time_gr</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># data for x axis for atm/baro/tides data</span>
        <span class="n">baro</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># barometric correction data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tides</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># tide correction data</span>
        <span class="c1"># self.all_xef=[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span><span class="p">))</span>  <span class="c1"># numpy array for residuals of all drops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of v0 values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g0</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list of g0 values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">])))</span>  <span class="c1"># All residuals from gradient estimation fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ssresAr</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Standard deviations of fits with gradient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m0grad4Sig</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Standard deviations of gradient estimation fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m0grad</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">compare_gsoft_agdas</span> <span class="o">=</span> <span class="n">Compare_gsoft_agdas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">],</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">])</span>
        <span class="n">Polar</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Press</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># ind_ = open(&#39;ind.txt&#39;, &#39;w&#39;)</span>
        <span class="c1"># loop for all drops</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span><span class="p">):</span>

            <span class="c1"># ===========================================================================#</span>
            <span class="c1"># create drop dictionary with data from dropfile</span>
            <span class="n">drop_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">drop</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns_dropfile</span><span class="p">,</span> <span class="n">drop_line</span><span class="p">))</span>
            <span class="c1"># ===========================================================================#</span>
            <span class="c1"># load users define split to set</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_set</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Set&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Drp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_in_set</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Press</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Pres&#39;</span><span class="p">]))</span>

            <span class="c1"># ===========================================================================#</span>
            <span class="c1"># create raw dictionary with data from rawfile</span>
            <span class="n">raw_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">d1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns_rawfile</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">raw_line</span><span class="p">[:</span><span class="mi">5</span><span class="p">]))</span>
            <span class="n">d1</span><span class="p">[</span><span class="s1">&#39;ftime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_line</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span><span class="p">]</span>
            <span class="n">d2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">columns_rawfile</span><span class="p">[</span><span class="mi">6</span><span class="p">:],</span> <span class="n">raw_line</span><span class="p">[</span><span class="mi">5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span><span class="p">:</span><span class="mi">10</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span><span class="p">]))</span>
            <span class="n">raw</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">|</span> <span class="n">d2</span>
            <span class="c1"># ===========================================================================#</span>

            <span class="c1"># ===========================================================================#</span>
            <span class="c1"># get wave length of laser</span>
            <span class="n">laser</span> <span class="o">=</span> <span class="s1">&#39;I</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;LaserLock&#39;</span><span class="p">])</span>
            <span class="n">Lambda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="n">laser</span><span class="p">]</span>
            <span class="c1"># ===========================================================================#</span>
            <span class="c1"># polar correction from file</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">useFilePoleCorr</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">Polar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poleCorr_file</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()))</span>

            <span class="c1"># polar correction calculated for each drop from IERS file</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">useIERSPoleCorr</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                    <span class="n">Polar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dg</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">warning_window</span><span class="p">[</span><span class="s1">&#39;pole_corr_service&#39;</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># ===========================================================================#</span>
            <span class="c1"># compute of LST</span>
            <span class="n">fall</span> <span class="o">=</span> <span class="n">Fall</span><span class="p">()</span>
            <span class="c1"># Setters</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ksol</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">ksol</span> <span class="o">=</span> <span class="n">Fraction</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ksol_k</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">fall</span><span class="o">.</span><span class="n">set_ksol</span><span class="p">(</span><span class="n">ksol</span><span class="o">=</span><span class="n">ksol</span><span class="p">)</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setFringe</span><span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="s1">&#39;ftime&#39;</span><span class="p">])</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setLambda</span><span class="p">(</span><span class="n">Lambda</span><span class="p">)</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setScaleFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setMultiplex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])</span>
            <span class="c1"># fall.setGradient(self.stationData[&#39;gradient&#39;])</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setGradient</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()))</span>
            <span class="c1"># fall.setModulFreq(self.instrumentData[&#39;modulFreq&#39;])</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setModulFreq</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmodf</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()))</span>
            <span class="c1"># fall.setLpar(self.FG5X[&#39;Lpar&#39;])</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setLpar</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lpar</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setRubiFreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rubi_freq</span><span class="p">)</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setFrRange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">)</span>
            <span class="c1"># fall.setFrRange(frmin,frmax)</span>
            <span class="c1"># fall.setFRssRange(self.frmax, frminss)</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setKpar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setPcable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;Pcable&#39;</span><span class="p">])</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setAcable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;Acable&#39;</span><span class="p">])</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">setLcable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lcable</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kdis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">fall</span><span class="o">.</span><span class="n">checkKDIS</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kimp</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">fall</span><span class="o">.</span><span class="n">checkKIMP</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ksae</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">fall</span><span class="o">.</span><span class="n">checkKSAE</span><span class="p">()</span>
            <span class="c1"># Compute fit by least squere method</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">LST</span><span class="p">()</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">effectiveHeight</span><span class="p">()</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">effectiveHeightTop</span><span class="p">()</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">effectivePosition</span><span class="p">()</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">gTop</span><span class="p">()</span>
            <span class="n">fall</span><span class="o">.</span><span class="n">gTopCor</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Baro&#39;</span><span class="p">],</span> <span class="n">Polar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tt</span> <span class="o">=</span> <span class="n">fall</span><span class="o">.</span><span class="n">tt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">fall</span><span class="o">.</span><span class="n">Lambda</span>
            <span class="c1"># ===========================================================================#</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

            <span class="c1"># ===========================================================================#</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">fall</span><span class="o">.</span><span class="n">resgrad4</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m0grad</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">m0gradient</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">m0grad4Sig</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">m0grad4</span><span class="p">)</span>

            <span class="c1"># ind_.write(&#39;{},{} \n&#39;.format(str(fall.ind_covar[0]), str(fall.ind_covar[1])))</span>

            <span class="c1"># date in normal format</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;DOY&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">date_time</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">date</span><span class="p">()),</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
            <span class="c1"># ===========================================================================#</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="c1"># create line for estim file</span>
                <span class="n">estim_line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimLine</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">std_grad</span><span class="p">,</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Set&#39;</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Drp&#39;</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">m02_grad</span><span class="p">,</span>
                                            <span class="n">date_time</span><span class="p">)</span>
                <span class="c1"># print line to the estim file</span>
                <span class="n">estim</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">estim_line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;estim&#39;</span><span class="p">]))</span>

                <span class="c1"># Create line of estimgrad file</span>
                <span class="n">estim_grad_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Set&#39;</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Drp&#39;</span><span class="p">]]</span>
                <span class="n">estim_grad_line</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">estim_grad_line</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                <span class="n">estim_grad_line</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">estim_grad_line</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
                <span class="n">estim_grad_line</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">xgrad4</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">estim_grad_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">stdGradX</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="n">estim_grad</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">estim_grad_line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;estim_grad&#39;</span><span class="p">]))</span>

            <span class="c1"># decision if measuring is accepted by kalpha</span>
            <span class="n">accepted</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># self.ssresAr.append(fall.ssres)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ssresAr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">m02_grad</span><span class="p">)</span>
            <span class="c1"># if fall.ssres &gt; kalpha:</span>
            <span class="c1">#     accepted = False</span>

            <span class="c1"># residuals added into matrix with all residuals</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">fall</span><span class="o">.</span><span class="n">res_grad1</span>

            <span class="c1"># date for database</span>
            <span class="n">date_database</span> <span class="o">=</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">day</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">drop</span><span class="p">[</span>
                <span class="s1">&#39;Time&#39;</span><span class="p">]</span>
            <span class="n">day_</span> <span class="o">=</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">day_</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">day_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3600</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">day_</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">day_</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="mi">24</span> <span class="o">+</span> <span class="n">date</span><span class="o">.</span><span class="n">day</span>
            <span class="n">date_mjd</span> <span class="o">=</span> <span class="n">date_to_mjd</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]),</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">day_</span><span class="p">)</span>

            <span class="c1"># line for database</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">matr_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">m02_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Set&#39;</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Drp&#39;</span><span class="p">],</span> <span class="n">date_database</span><span class="p">,</span> <span class="n">date_mjd</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">g0_Gr</span><span class="p">,</span>
                             <span class="o">-</span> <span class="n">fall</span><span class="o">.</span><span class="n">gradient</span> <span class="o">*</span> <span class="n">fall</span><span class="o">.</span><span class="n">Grad</span><span class="p">,</span>
                             <span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Baro&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                             <span class="n">Polar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">gTopCor</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">Grad</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">xgrad4</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">m0gradient</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">std</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">xef</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">ssres</span><span class="p">,</span> <span class="n">accepted</span><span class="p">]</span>


            <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">warning_window</span><span class="p">[</span><span class="s1">&#39;pole_corr&#39;</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">matr_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">m02_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Set&#39;</span><span class="p">],</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Drp&#39;</span><span class="p">],</span> <span class="n">date_database</span><span class="p">,</span> <span class="n">date_mjd</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">x_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">g0_Gr</span><span class="p">,</span> <span class="o">-</span> <span class="n">fall</span><span class="o">.</span><span class="n">gradient</span> <span class="o">*</span> <span class="n">fall</span><span class="o">.</span><span class="n">Grad</span><span class="p">,</span>
                             <span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Load&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Baro&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                             <span class="n">Polar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">gTopCor</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">Grad</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">xgrad4</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">m0gradient</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">std</span><span class="p">,</span>
                             <span class="n">fall</span><span class="o">.</span><span class="n">xef</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">fall</span><span class="o">.</span><span class="n">ssres</span><span class="p">,</span> <span class="n">accepted</span><span class="p">]</span>

            <span class="n">compare_gsoft_agdas</span><span class="o">.</span><span class="n">add_gsoft</span><span class="p">(</span><span class="n">drop</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="mf">1e-6</span> <span class="o">+</span> <span class="n">fall</span><span class="o">.</span><span class="n">Grad</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
            <span class="n">compare_gsoft_agdas</span><span class="o">.</span><span class="n">add_agdas</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">g0</span><span class="p">)</span>

            <span class="c1"># send line to database</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">matrDatabase</span><span class="p">[</span><span class="s1">&#39;insert&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">matr_drop</span><span class="p">))</span>
            <span class="c1"># send message to logging window</span>
            <span class="n">mess</span> <span class="o">=</span> <span class="s1">&#39;Drop: </span><span class="si">{}</span><span class="s1"> &gt;&gt; g0: </span><span class="si">{:.2f}</span><span class="s1"> std: </span><span class="si">{:.2f}</span><span class="s1">  eff.height: </span><span class="si">{:.2f}</span><span class="s1">  gtop: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span><span class="p">))),</span> <span class="n">fall</span><span class="o">.</span><span class="n">g0_Gr</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fall</span><span class="o">.</span><span class="n">m02_grad</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">fall</span><span class="o">.</span><span class="n">h</span> <span class="o">/</span> <span class="mf">1e7</span><span class="p">,</span> <span class="n">fall</span><span class="o">.</span><span class="n">gTopCor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progressBar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span><span class="p">))</span>

            <span class="c1"># data for atmsorefic graphs</span>
            <span class="n">atm</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Baro&#39;</span><span class="p">]))</span>
            <span class="n">baro</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Pres&#39;</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Tide&#39;</span><span class="p">]))</span>
            <span class="n">time1</span> <span class="o">=</span> <span class="n">drop</span><span class="p">[</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">time1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time1</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">3600</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">time1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">time1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">time1</span> <span class="o">&lt;</span> <span class="n">time_gr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">time1</span> <span class="o">+=</span> <span class="mi">24</span>
            <span class="n">time_gr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time1</span><span class="p">)</span>

            <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
            <span class="c1"># QtCore.QCoreApplication.sendPostedEvents()</span>

        <span class="c1"># commit data to database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Measurement processing has been successfully completed&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="c1"># close connection with database</span>
        <span class="c1"># self.matr_connection.close()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="c1"># create outputs which doesn&#39;t require statistic processing</span>
            <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;atm_corr&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                      <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;atm_corr&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                      <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;atm_corr&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                      <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;atm_corr&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
            <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">time_gr</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">atm</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b+&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atm_corr&#39;</span><span class="p">])</span>
            <span class="c1"># g.saveSourceData()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;atm_press&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                      <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;atm_press&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                      <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;atm_press&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                      <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;atm_press&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
            <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">time_gr</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">baro</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b+&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;atm_press&#39;</span><span class="p">])</span>
            <span class="c1"># g.saveSourceData()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;tides&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                      <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;tides&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                      <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;tides&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                      <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;tides&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
            <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">time_gr</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b+&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tides&#39;</span><span class="p">])</span>
            <span class="c1"># g.saveSourceData()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

            <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;polar_corr&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                      <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;polar_corr&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                      <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;polar_corr&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                      <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;polar_corr&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
            <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">time_gr</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">Polar</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b+&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;polar_corr&#39;</span><span class="p">])</span>
            <span class="c1"># g.saveSourceData()</span>
            <span class="n">g</span><span class="o">.</span><span class="n">decimal</span><span class="p">(</span><span class="n">decimal_number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

            <span class="c1"># Binary save of residuals</span>
            <span class="n">residuals_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="s1">&#39;Files&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_residuals&#39;</span><span class="p">)</span>
            <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">residuals_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span><span class="p">)</span>

        <span class="c1"># Compute statistics</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">complete_out</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="c1"># set nforfft = number of values for x vector for fft</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_nforfft</span><span class="p">()</span>
            <span class="c1"># ===========================================================================================================#</span>
            <span class="c1"># compute statistics for printing files</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reject_by_median_m0</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphHistogramAccDrops</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;_median_filter&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rejectBySigma</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">meanResidualsBySets</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fourier</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_avr_residuals_spectrum</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_normres</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_allanFile</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ressets_res</span><span class="p">()</span>
            <span class="n">compare_gsoft_agdas</span><span class="o">.</span><span class="n">print_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Accepted from results&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="n">compare_gsoft_agdas</span><span class="o">.</span><span class="n">print_histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">)</span>
            <span class="c1"># self.harmonic()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parasitic_wave</span><span class="p">()</span>

            <span class="c1"># ===========================================================================================================#</span>
            <span class="c1"># print results with gradient to estim file</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">writeDropsFile</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="s1">&#39;Cannot write file due statistic is not computed&#39;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_res_final</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="n">warning_window</span><span class="p">[</span><span class="s1">&#39;cannot_write_file&#39;</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>

            <span class="c1"># ===========================================================================================================#</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphGravityChange</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphVGG</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphSetG</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphHistogramAccDropsNorm</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphHistogramAccDrops</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;_fully_filtered&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphSensitivityStd</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphGravityChange_time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph_sensitivity_top_time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphResidualsBySets</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphResiduals</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphResidualsGradient</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphSpectrumParts</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphSpectrumRatio</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">graph_parasitic2</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph_sensitivity_top</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph_spectrum</span><span class="p">(</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graph_spectrum</span><span class="p">(</span><span class="s1">&#39;spectrum_avr&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_results_dat</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_file1</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sensitivity_file2</span><span class="p">()</span>

            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan1_normalized&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan1_normalized&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;allan1_normalized&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphAllan1</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">normres</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select gTopCor from results where Accepted = 1&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan1&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan1&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;allan1&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphAllan1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Gradient from results where Accepted = 1&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan3&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan3&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;allan3&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphAllan1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">Graph_EffHeight_CorToEffHeight</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphRes</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphParasitic</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">graphEffectiveHeights2</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allResGraph</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()</span>

            <span class="c1"># close estim and estim_grad files</span>
            <span class="n">estim</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">estim_grad</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matlog_file</span><span class="p">()</span>

        <span class="c1"># Change color of Run button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color:#f0f0f0;&quot;</span><span class="p">)</span>
        <span class="c1"># Set time of run calculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_time</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Calculation time: </span><span class="si">{:.2f}</span><span class="s1"> s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_time</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;color: red; font-size: 10pt&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notification</span><span class="p">()</span>
        <span class="n">date_last_version</span> <span class="o">=</span> <span class="n">get_date_last_version</span><span class="p">()</span>
        <span class="n">write_last_version</span><span class="p">(</span><span class="n">date_last_version</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.sensitivity_file1"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.sensitivity_file1">[docs]</a>    <span class="k">def</span> <span class="nf">sensitivity_file1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print sens1.csv file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Files/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_sens1.csv&#39;</span>
        <span class="n">sens</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot; Start</span><span class="si">{0}</span><span class="s2">   delta_g</span><span class="si">{0}</span><span class="s2">    Final</span><span class="si">{0}</span><span class="s2">   delta_g </span>
<span class="s2">                            fringe</span><span class="si">{0}</span><span class="s2">    [nm.s-2]</span><span class="si">{0}</span><span class="s2"> fringe</span><span class="si">{0}</span><span class="s2">    [nm.s-2]</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="n">sens</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.0f}{}</span><span class="s1"> </span><span class="si">{:.3f}{}</span><span class="s1"> </span><span class="si">{:.0f}{}</span><span class="s1"> </span><span class="si">{:.3f}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dglm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgrm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">sens</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgrm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1"> </span><span class="si">{:.5f}{}</span><span class="s1"> </span><span class="si">{:.3f}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgrm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">sens</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

        <span class="n">sens</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.sensitivity_file2"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.sensitivity_file2">[docs]</a>    <span class="k">def</span> <span class="nf">sensitivity_file2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print sens2.csv file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">header</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot; Start</span><span class="si">{0}</span><span class="s2">   delta_g</span><span class="si">{0}</span><span class="s2">    Final</span><span class="si">{0}</span><span class="s2">   delta_g </span>
<span class="s2">                     time</span><span class="si">{0}</span><span class="s2">    [nm.s-2]</span><span class="si">{0}</span><span class="s2">   time</span><span class="si">{0}</span><span class="s2">    [nm.s-2]</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="c1"># open file with path</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Files/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_sens2.csv&#39;</span>
        <span class="n">sens2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

        <span class="n">sens2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

        <span class="c1"># set indexes for self.ttlin vector due to step in sensitivity calculating</span>
        <span class="n">indsenstn_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indsenstn</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">indsensbn_ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indsensbn</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrtm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="c1"># create line</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.5f}{}</span><span class="s1"> </span><span class="si">{:.3f}{}</span><span class="s1"> </span><span class="si">{:.5f}{}</span><span class="s1"> </span><span class="si">{:.3f}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">indsenstn_ind</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">dgltm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">indsensbn_ind</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">dgrtm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
            <span class="n">sens2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="c1"># increase indexes by step</span>
            <span class="n">indsenstn_ind</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>
            <span class="n">indsensbn_ind</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrtm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgltm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="c1"># create line</span>
            <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.5f}{}</span><span class="s1"> </span><span class="si">{:.2f}{}</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">indsenstn_ind</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgltm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">],</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="n">sens2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="c1"># increase index by step</span>
            <span class="n">indsenstn_ind</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>

        <span class="n">sens2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.ressets_res"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.ressets_res">[docs]</a>    <span class="k">def</span> <span class="nf">ressets_res</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Distance calculation for fringe with time t.</span>
<span class="sd">        Computing medians of v0 and g0 by sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Distance calculation for fringe with time t&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="n">prescale</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span>

        <span class="n">nset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select max(Set1) from results&#39;</span><span class="p">)</span>
        <span class="n">nset</span> <span class="o">=</span> <span class="n">nset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">tfit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">v0m_bysets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g0m_bysets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tkor</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zzh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">,</span> <span class="n">nset</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nset</span><span class="p">):</span>

            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select v0_withGR from results where Set1 = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v0m_bysets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">)</span>

            <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select g0_Gr from results where Set1 = </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">g0m_bysets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">tkor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v0m_bysets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">g0m_bysets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">zzh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">9.809</span> <span class="o">*</span> <span class="p">(</span><span class="n">tfit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tkor</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">zzh</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zzh</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">*</span> <span class="mf">1e-9</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">prescale</span> <span class="o">*</span> <span class="n">j</span></div>

<div class="viewcode-block" id="Compute.notification"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.notification">[docs]</a>    <span class="k">def</span> <span class="nf">notification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show notification about end of calculating.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logo_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="s1">&#39;picture&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.ico&#39;</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select avg(gTopCor) from results where Accepted = 1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">Notification</span><span class="p">(</span><span class="n">app_id</span><span class="o">=</span><span class="s1">&#39;pyAgdas&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Computation has been successfully completed!&#39;</span><span class="p">,</span>
                         <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Average g at top of drops: </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">icon</span><span class="o">=</span><span class="n">logo_path</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">set_audio</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">Reminder</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">add_actions</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outputs&#39;</span><span class="p">,</span> <span class="n">launch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.matlog_file"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.matlog_file">[docs]</a>    <span class="k">def</span> <span class="nf">matlog_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print &quot;matlog&quot; file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">line</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;meterType&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;meterS/N&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;SiteCode&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;long&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;elev&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;airPressure&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;barometricFactor&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;modulFreq&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;0.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rubi_freq</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;Lpar&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e9</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ksol</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ksae</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kdis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kimp</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lcable</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;polarX&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;polarY&#39;</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">)</span>
        <span class="n">year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span>
        <span class="n">month</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">day</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">hour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">minute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">month</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hour</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">minute</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">date_to_mjd</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">month</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">day</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">hour</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">minute</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1440</span><span class="p">))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_duration</span><span class="p">())</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">press</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_avg_press</span><span class="p">()</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">press</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">press</span><span class="p">))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="p">))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="p">))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">95</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select count(*) from results where Accepted = 1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select avg(EffHeight) from results where Accepted = 1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hefm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select avg(EffHeight + CorToEffHeight) from results where Accepted = 1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hefm</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select EffHeight + CorToEffHeight from results where Accepted = 1&#39;</span><span class="p">),</span>
                   <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;actualHeight&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">hefm</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">hefm</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gstd</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dglrms</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrrms</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span><span class="p">)</span>
        <span class="n">line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mggp3</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_count_gradients</span><span class="p">()))</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;matlog&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                      <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;matlog&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="n">a</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.get_count_gradients"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.get_count_gradients">[docs]</a>    <span class="k">def</span> <span class="nf">get_count_gradients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get number of filtered gradient.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">gradients</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Gradient from results where Accepted = 1&#39;</span><span class="p">)</span>
        <span class="n">vggp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gradients</span><span class="p">)</span>
        <span class="n">mggp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">gradients</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">vggp3_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gradients</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">vggp2</span> <span class="o">-</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rejsig</span> <span class="o">*</span> <span class="n">mggp2</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">vggp3_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vggp3_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vggp3_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mggp3_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">vggp3_list</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span></div>

<div class="viewcode-block" id="Compute.get_avg_press"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.get_avg_press">[docs]</a>    <span class="k">def</span> <span class="nf">get_avg_press</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get weight average of pressure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        m: float</span>
<span class="sd">            weight average of pressure</span>
<span class="sd">        press: list</span>
<span class="sd">            values of pressure from Drop file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">press</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)):</span>
            <span class="n">press</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">press</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">m</span> <span class="o">+=</span> <span class="n">press</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">press</span></div>

<div class="viewcode-block" id="Compute.get_duration"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.get_duration">[docs]</a>    <span class="k">def</span> <span class="nf">get_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get number of hours between first and final drop</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        d: float</span>
<span class="sd">            number of hours between first and final drop</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Date from results where n = 1 or n = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span><span class="p">))</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">d1_date</span><span class="p">,</span> <span class="n">d1_time</span> <span class="o">=</span> <span class="n">d1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">d2_date</span><span class="p">,</span> <span class="n">d2_time</span> <span class="o">=</span> <span class="n">d2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

        <span class="n">d1</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">d1_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d1_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d1_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span>
                      <span class="nb">int</span><span class="p">(</span><span class="n">d1_time</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d1_time</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d1_time</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">d2</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">d2_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d2_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d2_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]),</span>
                      <span class="nb">int</span><span class="p">(</span><span class="n">d2_time</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d2_time</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d2_time</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">d2</span> <span class="o">-</span> <span class="n">d1</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1440</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="mi">60</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">d</span></div>

<div class="viewcode-block" id="Compute.allanGraph"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.allanGraph">[docs]</a>    <span class="k">def</span> <span class="nf">allanGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create loglog graph of allan standard deviations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : list</span>
<span class="sd">            result of allan function</span>
<span class="sd">        tau : list</span>
<span class="sd">            list with number of intervals</span>
<span class="sd">        path : str</span>
<span class="sd">            output folder</span>
<span class="sd">        type : str</span>
<span class="sd">            normalized data/VGG</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span>
        <span class="n">p</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)],</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">a</span><span class="p">],</span> <span class="s1">&#39;.r&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)],</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tau</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))],</span> <span class="s1">&#39;-r&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)],</span> <span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)]],</span> <span class="p">[[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))],</span>
                                              <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))]],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span>
               <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">0.95</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)]],</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">1.05</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)]]],</span>
               <span class="p">[[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))],</span>
                <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))]],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">0.95</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)]],</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">1.05</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tau</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)]]],</span>
               <span class="p">[[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))],</span>
                <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))]],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># legend = []</span>
        <span class="c1"># legend.append(&#39;Mean values&#39;)</span>
        <span class="c1"># legend.append(&#39;White noise&#39;)</span>
        <span class="c1"># [legend.append(&#39;data {}&#39;.format(i+1)) for i in range(len(tau))]</span>
        <span class="c1"># p.legend(legend)</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;normalized data&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_deviation&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_deviation&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_deviation&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_deviation&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;VGG&#39;</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">]</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;allan_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphAllan1"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphAllan1">[docs]</a>    <span class="k">def</span> <span class="nf">graphAllan1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create graph with drop data.</span>

<span class="sd">        data : list</span>
<span class="sd">            list of plotting data</span>
<span class="sd">        title : str</span>
<span class="sd">            title of the graph</span>
<span class="sd">        ylabel : str</span>
<span class="sd">            y label</span>
<span class="sd">        name: str</span>
<span class="sd">            name of the graph</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data_centered</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="n">median</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>  <span class="c1"># data centered on median</span>
        <span class="n">median1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data_centered</span><span class="p">))</span> <span class="o">/</span> <span class="mf">0.6745</span>  <span class="c1"># median from absolute value of residuals</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_centered</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="c1"># p.plot([0, len(data_centered)], [5 * median1, 5 * median1], &#39;r&#39;, lw=0.5)</span>
        <span class="c1"># p.plot([0, len(data_centered)], [-5 * median1, -5 * median1], &#39;r&#39;, lw=0.5)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="n">median1</span> <span class="o">-</span> <span class="n">median1</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">median1</span> <span class="o">+</span> <span class="n">median1</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Drop #&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphSpectrumRatio"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphSpectrumRatio">[docs]</a>    <span class="k">def</span> <span class="nf">graphSpectrumRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph - spectrum_ratio.</span>
<span class="sd">        Plot 2 subplot in one graph</span>
<span class="sd">        1) FFT of average and average of FFT</span>
<span class="sd">        2) their ratio</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># frmin = self.gravimeter[&#39;frmin&#39;]</span>
        <span class="c1"># frmax = self.gravimeter[&#39;frmax&#39;]</span>
        <span class="c1"># nforfft = self.gravimeter[&#39;nforfft&#39;]</span>
        <span class="n">indexpad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select count(*) from results where Accepted = 1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">frk</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">fr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frk</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># ratio of arrays</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">yfdMean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">yffa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yffa</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="c1"># plotting of graph</span>
        <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fr</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">yffa</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">fr</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfdMean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">:],</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;legend1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.64</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">fr</span><span class="p">),</span> <span class="n">fs</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">indexpad</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">indexpad</span><span class="p">)],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;legend2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_ratio&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel2&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="c1"># save graph</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;spectrum_ratio&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphSpectrumParts"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphSpectrumParts">[docs]</a>    <span class="k">def</span> <span class="nf">graphSpectrumParts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spectrum comparison for 2 parts of drops. Graph - spectrum_parts. Graph1 - Amplitude, graph2 - Ratio.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># frmin = self.gravimeter[&#39;frmin&#39;]</span>
        <span class="c1"># frmax = self.gravimeter[&#39;frmax&#39;]</span>
        <span class="c1"># nforfft = self.gravimeter[&#39;nforfft&#39;]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span><span class="p">)</span>
        <span class="n">tin1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span><span class="p">)</span>
        <span class="n">tin2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span><span class="p">)</span>

        <span class="n">res1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">tin1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">res2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">tin2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>

        <span class="n">yres1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">res1</span><span class="p">)</span>
        <span class="n">yres1a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yres1</span><span class="p">[:</span><span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)])</span>

        <span class="n">yres2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">res2</span><span class="p">)</span>
        <span class="n">yres2a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">yres2</span><span class="p">[:</span><span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)])</span>

        <span class="n">fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">fs1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">tin1</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tin1</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">frk1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fs1</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">fr1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">frk1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))]</span>

        <span class="n">fs2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">tin2</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tin2</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">frk2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fs2</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">fr2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="n">frk2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))]</span>

        <span class="n">frx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">yres1x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">frx</span><span class="p">,</span> <span class="n">fr1</span><span class="p">,</span> <span class="n">yres1a</span><span class="p">)</span>
        <span class="n">yres2x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">frx</span><span class="p">,</span> <span class="n">fr2</span><span class="p">,</span> <span class="n">yres2a</span><span class="p">)</span>

        <span class="n">ratio</span> <span class="o">=</span> <span class="p">[</span><span class="n">yres1x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">yres2x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">yres1x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">frx</span><span class="p">,</span> <span class="n">yres1x</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">frx</span><span class="p">,</span> <span class="n">yres2x</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_parts&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_parts&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_parts&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_parts&#39;</span><span class="p">][</span><span class="s1">&#39;legend1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">frx</span><span class="p">,</span> <span class="n">ratio</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.64</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">loglog</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">frx</span><span class="p">),</span> <span class="n">fs</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_parts&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_parts&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel2&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_parts&#39;</span><span class="p">][</span><span class="s1">&#39;legend2&#39;</span><span class="p">]])</span>

        <span class="n">p</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;spectrum_parts&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graph_spectrum"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graph_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">graph_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create graphs - spectrum and spectrum_avr.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        type : str</span>
<span class="sd">            spectrum/spectrum_avr</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;spectrum&#39;</span><span class="p">:</span>
            <span class="n">x_by_sets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfsa</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yffa</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;spectrum_avr&#39;</span><span class="p">:</span>
            <span class="n">x_by_sets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfdMeanBySet</span>
            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfdMean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum_avr&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>

        <span class="n">start</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">legend</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">frk</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>

        <span class="n">fr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frk</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span>
        <span class="n">p</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x_by_sets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">p</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fr</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span> <span class="n">x_by_sets</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">start</span><span class="p">:],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">legend</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">][</span><span class="s1">&#39;set_description&#39;</span><span class="p">],</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">p</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">fr</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span> <span class="n">x</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># printing envelope</span>
        <span class="n">frenv</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">valenv_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frenv</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">0.25</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;valenv&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">valenv_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">frenv</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span> <span class="n">valenv_y</span><span class="p">[</span><span class="n">start</span><span class="p">:],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="n">legend</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e5</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphResidualsGradient"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphResidualsGradient">[docs]</a>    <span class="k">def</span> <span class="nf">graphResidualsGradient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of residuals from gradient fit. Graph - residuals_gradient.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># self.resgradsum4Mean = np.loadtxt(&#39;resgradsum4x.csv&#39;, delimiter = &#39;;&#39;)</span>
        <span class="n">yl</span> <span class="o">=</span> <span class="mf">0.75</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="c1"># aa, bb = sig.butter(n, self.kcutoff, btype=&#39;low&#39;)</span>
        <span class="c1"># self.resgradsum4filt = sig.filtfilt(aa, bb, self.resgradsum4Mean[:self.gravimeter[&#39;frmaxplot&#39;]])</span>

        <span class="n">resm0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">tt0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>

        <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">yl</span><span class="p">,</span> <span class="n">yl</span><span class="p">]</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">]]</span>
        <span class="n">xxlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]]</span>

        <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpb</span>
        <span class="n">mpb</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">mpb</span><span class="o">.</span><span class="n">pyplot</span>
        <span class="n">p</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt0</span><span class="p">,</span> <span class="n">resm0</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>

        <span class="c1"># p.plot(tt[:frmaxplot], resmm, &#39;-k&#39;, lw = 2)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span>
               <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">resgradsm4filt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
               <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
               <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">rmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">])</span>
        <span class="n">rmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="n">rmin</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">rmax</span><span class="p">])</span>

        <span class="c1"># first and last fringe</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xxlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">rmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xxlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="o">-</span><span class="n">rmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_gradient&#39;</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;residuals_gradient&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">mpb</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Qt5Agg&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.graphResiduals"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphResiduals">[docs]</a>    <span class="k">def</span> <span class="nf">graphResiduals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of residuals. Graph - residuals.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">yl</span> <span class="o">=</span> <span class="mf">0.75</span>  <span class="c1"># ylimit</span>
        <span class="n">resm0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">tt0</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nfringe</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>

        <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">yl</span><span class="p">,</span> <span class="n">yl</span><span class="p">]</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">]]</span>
        <span class="n">xxlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]]</span>

        <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpb</span>
        <span class="n">mpb</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span>

        <span class="n">siz</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># range for y axes</span>

        <span class="c1"># r = self.matr_connection.get(&#39;select Accepted from results&#39;)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">mpb</span><span class="o">.</span><span class="n">pyplot</span>
        <span class="n">p</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt0</span><span class="p">,</span> <span class="n">resm0</span><span class="p">,</span> <span class="s1">&#39;-k&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xxlim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="n">i</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tinc_filt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yn</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:pink&#39;</span><span class="p">)</span>
        <span class="c1"># p.plot(self.resmmi, self.yn, &#39;-&#39;, lw=3, color=&#39;tab:pink&#39;)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="o">-</span><span class="n">yl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xxlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.001</span><span class="p">,</span> <span class="o">-</span><span class="n">yl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">p</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;residuals&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">mpb</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Qt5Agg&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.allResGraph"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.allResGraph">[docs]</a>    <span class="k">def</span> <span class="nf">allResGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of all residuals. Graph - resid_all.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpb</span>
        <span class="n">mpb</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ps&#39;</span><span class="p">)</span>

        <span class="n">siz</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># range for y axes</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Accepted from results&#39;</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">mpb</span><span class="o">.</span><span class="n">pyplot</span>
        <span class="n">p</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="n">siz</span><span class="p">,</span> <span class="n">siz</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">siz</span><span class="p">,</span> <span class="n">siz</span><span class="p">],</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">siz</span><span class="p">,</span> <span class="n">siz</span><span class="p">],</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;resid_all&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;resid_all&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;resid_all&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)):</span>
            <span class="n">acc</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">acc</span><span class="p">:</span>
                <span class="c1"># black color</span>
                <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="s1">&#39;-k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># grey color</span>
                <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;resid_all&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">mpb</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Qt5Agg&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.graphResidualsBySets"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphResidualsBySets">[docs]</a>    <span class="k">def</span> <span class="nf">graphResidualsBySets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Printing shifted residuals by sets to graph. Graph - residuals_shifted.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># frmin = self.gravimeter[&#39;frmin&#39;]  # start fringe</span>
        <span class="c1"># frmax = self.gravimeter[&#39;frmax&#39;]  # final fringe</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">]</span>  <span class="c1"># data for x axis</span>

        <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mark</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">col_name</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">XX</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># shifted lines</span>
        <span class="n">YY</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">markk</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lww</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">text_x</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># description of lines, Set 1-nset</span>
        <span class="n">text_y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">text_color</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">:</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">j</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">l</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">]]</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">mark</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-k&#39;</span><span class="p">)</span>
            <span class="n">col_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_shifted&#39;</span><span class="p">][</span><span class="s1">&#39;set_description&#39;</span><span class="p">],</span> <span class="n">j</span><span class="p">))</span>
            <span class="n">lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
            <span class="n">text_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.265</span><span class="p">)</span>
            <span class="n">text_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">text_color</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

            <span class="n">XX</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">YY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
            <span class="n">markk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-b&#39;</span><span class="p">)</span>
            <span class="n">lww</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># start fringe</span>
        <span class="n">XX</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">]])</span>
        <span class="n">YY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">])</span>
        <span class="n">markk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-b&#39;</span><span class="p">)</span>
        <span class="n">lww</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="c1"># final fringe</span>
        <span class="n">XX</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]])</span>
        <span class="n">YY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">])</span>
        <span class="n">markk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-b&#39;</span><span class="p">)</span>
        <span class="n">lww</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;residuals_shifted&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_shifted&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_shifted&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;residuals_shifted&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">winsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="n">mark</span><span class="p">,</span> <span class="n">columns_name</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">XX</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">YY</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="n">markk</span><span class="p">,</span> <span class="n">columns_name</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lww</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">t</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Start fringe&#39;</span><span class="p">,</span> <span class="s1">&#39;Final fringe&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">text_x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">text_y</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">text_color</span><span class="p">)</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="k">del</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">x</span></div>

<div class="viewcode-block" id="Compute.graphVGG"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphVGG">[docs]</a>    <span class="k">def</span> <span class="nf">graphVGG</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create graph of gradients. Graph - vgg.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Gradient, GradientLSTm0, n from results where Accepted = 1&#39;</span><span class="p">)</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>

        <span class="n">moving_average</span><span class="p">,</span> <span class="n">moving_avg_x</span> <span class="o">=</span> <span class="n">movingAverage</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">grad</span><span class="p">)</span>  <span class="c1"># average value of gradients</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mggp3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># standart deviation of gradients</span>
        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span><span class="p">]</span>  <span class="c1"># xrange</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span><span class="p">]</span>  <span class="c1"># yrange for mean</span>
        <span class="n">yylim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mggp3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mggp3</span><span class="p">]</span>  <span class="c1"># yrange for -3sigma</span>
        <span class="n">yyylim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mggp3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vggp3</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mggp3</span><span class="p">]</span>  <span class="c1"># yrange for +3sigma</span>

        <span class="n">m0</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># vector of m0 values</span>
        <span class="c1"># x = []  # x range for plotting data</span>
        <span class="n">cumulative_average</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">m0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># x.append(i)</span>
            <span class="n">cumulative_average</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">grad</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">grad</span><span class="p">[:</span><span class="n">i</span><span class="p">]))</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vgg&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;vgg&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;vgg&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;vgg&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">winsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
        <span class="n">g</span><span class="o">.</span><span class="n">error_bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">moving_avg_x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">xlim</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">cumulative_average</span><span class="p">,</span> <span class="n">moving_average</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">yylim</span><span class="p">,</span> <span class="n">yyylim</span><span class="p">],</span>
                 <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">,</span> <span class="s1">&#39;-y&#39;</span><span class="p">],</span>
                 <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cumulative_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;moving_average&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;-3sigma_range&#39;</span><span class="p">,</span> <span class="s1">&#39;+3sigma_range&#39;</span><span class="p">],</span>
                 <span class="n">legend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;vgg&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span>
                 <span class="n">lw</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphSensitivityStd"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphSensitivityStd">[docs]</a>    <span class="k">def</span> <span class="nf">graphSensitivityStd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Variability of set g-values on the choice of first and final fringe. Graph - sensitivity_std.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># xrange</span>
        <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">)</span>

        <span class="c1"># legend</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_std&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensa_tn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_tx</span><span class="p">,</span>
                                                                               <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dglrms</span><span class="p">))</span>
        <span class="n">l2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_std&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sensa_bn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_bx</span><span class="p">,</span>
                                                                               <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrrms</span><span class="p">))</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sensitivity_std&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_std&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_std&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_std&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dglrms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgrrms</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;k+-&#39;</span><span class="p">,</span> <span class="s1">&#39;r+-&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">],</span>
                 <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">],</span>
                 <span class="n">lw</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">x_ax_int</span><span class="p">()</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphGravityChange"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphGravityChange">[docs]</a>    <span class="k">def</span> <span class="nf">graphGravityChange</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of sensitivity - sensitivity_bottom.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># l = []</span>
        <span class="n">cn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># x range</span>
        <span class="n">tttt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">tttt</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tttt</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">]</span>

        <span class="c1"># sensitivity data</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgr</span><span class="p">)):</span>
            <span class="c1"># g.plotXY(x=[tttt], y=[dgr[i,:]], mark=[&#39;C&#39;+str((i)%10)+ &#39;-&#39;], columns_name=[&#39;Set &#39; + str(i+1)], legend =[&#39;Set &#39; + str(i+1)])</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tttt</span><span class="p">)</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">tttt</span><span class="p">)])</span>
            <span class="c1"># l.append(&#39;{} &#39;.format(self.graph_lang[&#39;sensitivity_bottom&#39;][&#39;set_description&#39;]) + str(i + 1))</span>
            <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Set &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;C&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tttt</span><span class="p">)</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrm</span><span class="o">.</span><span class="n">T</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">tttt</span><span class="p">)])</span>
        <span class="c1"># l.append(self.graph_lang[&#39;sensitivity_bottom&#39;][&#39;legend&#39;])</span>
        <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_bottom&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sensitivity_bottom&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_bottom&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_bottom&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">tttt</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tttt</span><span class="p">))]],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b-&#39;</span><span class="p">],</span>
                 <span class="n">columns_name</span><span class="o">=</span><span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">lw</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">columns_name</span><span class="o">=</span><span class="n">cn</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="k">del</span> <span class="n">X</span>
        <span class="k">del</span> <span class="n">Y</span></div>

<div class="viewcode-block" id="Compute.graphGravityChange_time"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphGravityChange_time">[docs]</a>    <span class="k">def</span> <span class="nf">graphGravityChange_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of sensitivity - sensitivity_bottom_time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Y</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># l = []</span>
        <span class="n">cn</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># sensitivity data</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">):</span>
            <span class="c1"># g.plotXY(x=[tttt], y=[dgr[i,:]], mark=[&#39;C&#39;+str((i)%10)+ &#39;-&#39;], columns_name=[&#39;Set &#39; + str(i+1)], legend =[&#39;Set &#39; + str(i+1)])</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tttt_plot</span><span class="p">)</span>
            <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tttt_plot</span><span class="p">)])</span>
            <span class="c1"># l.append(&#39;{} &#39;.format(self.graph_lang[&#39;sensitivity_bottom_time&#39;][&#39;set_description&#39;]) + str(i + 1))</span>
            <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Set &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;C&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>

        <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tttt_plot</span><span class="p">)</span>
        <span class="n">Y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrtm</span><span class="o">.</span><span class="n">T</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tttt_plot</span><span class="p">)])</span>
        <span class="c1"># l.append(self.graph_lang[&#39;sensitivity_bottom_time&#39;][&#39;legend&#39;])</span>
        <span class="n">cn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_bottom_time&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">])</span>
        <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
        <span class="n">lw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;sensitivity_bottom_time&#39;</span><span class="p">,</span>
                  <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_bottom_time&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_bottom&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="c1"># g.plotXY(x=[self.ttttlin], y=[[0 for i in range(len(self.ttr[i, :]))]], mark=[&#39;b-&#39;], columns_name=&#39;xx&#39;, legend=&#39;&#39;, lw=[0.3])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">tttt_plot</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tttt_plot</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span> <span class="n">y</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b-&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">indsensfrmax</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">indsensfrmax</span><span class="p">]]],</span> <span class="n">y</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b-&#39;</span><span class="p">])</span>
        <span class="c1"># g.plotXY(x=[[self.ttr[self.frmax], self.ttr[self.frmax]]], y=[[-10, 10]], mark=[&#39;b-&#39;],</span>
        <span class="c1">#          columns_name=&#39;xx&#39;, legend=&#39;&#39;,</span>
        <span class="c1">#          lw=[0.3])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">mark</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">columns_name</span><span class="o">=</span><span class="n">cn</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="k">del</span> <span class="n">X</span>
        <span class="k">del</span> <span class="n">Y</span></div>

<div class="viewcode-block" id="Compute.generate_report"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.generate_report">[docs]</a>    <span class="k">def</span> <span class="nf">generate_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate report from results.dat and pictures from pictures list.</span>
<span class="sd">        Report is generated to docx file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pictures</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;\*allan1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*histogram_fully_filtered.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*allan_deviation.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*effective_height.png&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;\*set_g.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*set_std.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*residuals.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*resid_RMS.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*sensitivity_top.png&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;\*sensitivity_bottom.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*spectrum_avr.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*spectrum.png&#39;</span><span class="p">,</span> <span class="s1">&#39;\*vgg.png&#39;</span><span class="p">]</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="s1">&#39;Graphs&#39;</span><span class="p">)</span>
        <span class="n">path1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="s1">&#39;Files&#39;</span><span class="p">)</span>
        <span class="n">path1</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path1</span> <span class="o">+</span> <span class="s1">&#39;\*results.dat&#39;</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">results1</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">results</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
        <span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">section</span><span class="o">.</span><span class="n">page_height</span> <span class="o">=</span> <span class="n">Mm</span><span class="p">(</span><span class="mi">210</span><span class="p">)</span>
        <span class="n">section</span><span class="o">.</span><span class="n">page_width</span> <span class="o">=</span> <span class="n">Mm</span><span class="p">(</span><span class="mi">297</span><span class="p">)</span>

        <span class="n">run</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">add_paragraph</span><span class="p">()</span><span class="o">.</span><span class="n">add_run</span><span class="p">(</span><span class="n">results1</span><span class="p">)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">font</span>
        <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Courier New&#39;</span>
        <span class="n">font</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pictures</span><span class="p">)):</span>
            <span class="n">pic_path</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">pictures</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">sections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">section</span><span class="o">.</span><span class="n">page_height</span> <span class="o">=</span> <span class="n">Mm</span><span class="p">(</span><span class="mi">210</span><span class="p">)</span>
            <span class="n">section</span><span class="o">.</span><span class="n">page_width</span> <span class="o">=</span> <span class="n">Mm</span><span class="p">(</span><span class="mi">297</span><span class="p">)</span>

            <span class="n">document</span><span class="o">.</span><span class="n">add_picture</span><span class="p">(</span><span class="n">pic_path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="s1">&#39;Files&#39;</span><span class="p">,</span> <span class="s1">&#39;report.docx&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
            <span class="ne">Warning</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="s1">&#39;Close the report!&#39;</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Warning&#39;</span><span class="p">)</span>

        <span class="n">document</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="s1">&#39;Files&#39;</span><span class="p">,</span> <span class="s1">&#39;report.docx&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="Compute.graphSetG"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphSetG">[docs]</a>    <span class="k">def</span> <span class="nf">graphSetG</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of sets results - set_g.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g0</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">statistic</span><span class="p">[</span><span class="s1">&#39;mean:vxv&#39;</span><span class="p">])</span>
        <span class="n">mean_by_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">g0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>

        <span class="c1"># Set gravity at top of the drop</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;set_g&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;set_g&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;set_g&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g0</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;set_g&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">error_bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">mean_by_set</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stodchmod</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span>
                 <span class="n">y</span><span class="o">=</span><span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="n">g0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="n">g0</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="n">g0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="n">g0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstd</span><span class="p">],</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="n">g0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="n">g0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gstd</span><span class="p">]],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">],</span>
                 <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;mean-1σ&#39;</span><span class="p">,</span> <span class="s1">&#39;mean+1σ&#39;</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;set_g&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">x_ax_int</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="c1"># Standart deviation for set g-values</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;set_std&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;set_std&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;set_std&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;set_std&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="c1"># g.plotXY(x=[x, x, x], y=[[gfinal-g0, gfinal-g0], [gfinal-g0-gstd, gfinal-g0-gstd], [gfinal-g0+gstd, gfinal-g0+gstd]], mark=[&#39;b-&#39;, &#39;g-&#39;, &#39;g-&#39;], columns_name=[&#39;Sine component&#39;, &#39;Cosine component&#39;], legend =[&#39;Set g-values&#39;, &#39;Avegare g-value&#39;, &#39;1 range&#39;])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">error_bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stodchs</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphRes"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphRes">[docs]</a>    <span class="k">def</span> <span class="nf">graphRes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of standart deviations for each drop - resid_RMS.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">rms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select n, ssres from results&#39;</span><span class="p">)</span>
        <span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rms</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">std</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;resid_RMS&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;resid_RMS&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;resid_RMS&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;resid_RMS&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">std</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-g&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rms&#39;</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="p">[])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]],</span> <span class="n">y</span><span class="o">=</span><span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">kalpha_resid_rms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalpha_resid_rms</span><span class="p">]],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-r&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">text</span><span class="p">([</span><span class="n">n</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kalpha_resid_rms</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;resid_RMS&#39;</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">])</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalpha_resid_rms</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

        <span class="c1"># acc = self.matr_connection.get(&#39;select Accepted from results&#39;)</span>
        <span class="c1"># g=Graph(path=self.projDirPath+&#39;/Graphs&#39;, name=&#39;resid_all&#39;, project = self.stationData[&#39;ProjName&#39;], show=self.open_graphs.isChecked(), x_label=&#39;Fringe #&#39;, y_label = &#39;Residual /nm&#39;, title=&#39;Residuals for each drop&#39;)</span>
        <span class="c1"># x=range(1, self.frmaxss + 1)</span>
        <span class="c1"># for i in range(len(acc)):</span>
        <span class="c1">#     if acc[i][0] == 1:</span>
        <span class="c1">#         # g.plotXY(x=[x], y=[self.allRes[i, :]], mark=[&#39;-k&#39;], columns_name=[], legend =[])</span>
        <span class="c1">#         g.gr.plot(x, self.allRes[i, :], &#39;-k&#39;)</span>
        <span class="c1">#</span>
        <span class="c1"># # g.saveSourceData()</span>
        <span class="c1"># g.save()</span>

<div class="viewcode-block" id="Compute.graphParasitic"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphParasitic">[docs]</a>    <span class="k">def</span> <span class="nf">graphParasitic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of parasitic wavelength parameters - parasitic.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select e_withGR, f_withGR, n from results where Accepted = 1&#39;</span><span class="p">)</span>

        <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>
        <span class="c1"># x = range(1, len(e) + 1)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">res</span><span class="p">]</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;parasitic&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">(),</span> <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                      <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lpar</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())))</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sine component&#39;</span><span class="p">,</span> <span class="s1">&#39;Cosine component&#39;</span><span class="p">],</span>
                 <span class="n">legend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic&#39;</span><span class="p">][</span><span class="s1">&#39;legend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphHistogramAccDrops"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphHistogramAccDrops">[docs]</a>    <span class="k">def</span> <span class="nf">graphHistogramAccDrops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Histogram of accepted drops. Graphs - median_filter/fully_filtered.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            median_filter/fully_filtered</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select gTopCor from results where Accepted = 1&#39;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;histogram&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;histogram&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;histogram&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;histogram&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
                  <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">g</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphHistogramAccDropsNorm"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphHistogramAccDropsNorm">[docs]</a>    <span class="k">def</span> <span class="nf">graphHistogramAccDropsNorm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Histogram of accepted normalized drops. Graphs - median_filter/fully_filtered.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;histogram_norm&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;histogram_norm&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;histogram_norm&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;histogram_norm&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">g</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normres</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># g.saveSourceData()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graphEffectiveHeights2"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graphEffectiveHeights2">[docs]</a>    <span class="k">def</span> <span class="nf">graphEffectiveHeights2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of effective heights - effective_height2.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select EffHeight + CorToEffHeight from results&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndrop</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;effective_height2&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span>
                  <span class="n">x_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;effective_height2&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span>
                  <span class="n">y_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;effective_height2&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span>
                  <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;effective_height2&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">show</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">open_graphs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="n">g</span><span class="o">.</span><span class="n">plotXY</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">mark</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-b&#39;</span><span class="p">],</span> <span class="n">columns_name</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;effective_height2&#39;</span><span class="p">])</span>
        <span class="n">g</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.estimLine"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.estimLine">[docs]</a>    <span class="k">def</span> <span class="nf">estimLine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">std</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">set</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">drop</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">m0</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">date_time</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate line of estim file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : list</span>
<span class="sd">            results of the fit</span>
<span class="sd">        std : list</span>
<span class="sd">            standard deviations of results from the fit</span>
<span class="sd">        set : str</span>
<span class="sd">            number of set</span>
<span class="sd">        drop : str</span>
<span class="sd">            number of drop</span>
<span class="sd">        m0 : list</span>
<span class="sd">            m0 from fit</span>
<span class="sd">        date_time : str</span>
<span class="sd">            date of the drop</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dropResult : list</span>
<span class="sd">            line for estim file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dropResult</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">,</span> <span class="n">drop</span><span class="p">,</span> <span class="n">date_time</span><span class="p">,</span> <span class="n">m0</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
            <span class="n">dropResult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">dropResult</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">std</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">dropResult</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">1e6</span>
        <span class="n">dropResult</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">1e6</span>
        <span class="n">dropResult</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">1e6</span>
        <span class="n">dropResult</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">/=</span> <span class="mf">1e6</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">dropResult</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">dropResult</span></div>

<div class="viewcode-block" id="Compute.writeDropsFile"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.writeDropsFile">[docs]</a>    <span class="k">def</span> <span class="nf">writeDropsFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write drops file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;SELECT Set1, Drop1, Date, mjd, g0_Gr, CorrToTop, Tide, Load, Baro, Polar, gTopCor, g0, EffHeight, CorToEffHeight, Accepted from results&#39;</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;drops&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                      <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;drops&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">k</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:| &#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

            <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stdodchpadu</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)):</span>
                <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ampar</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fazepar</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="c1"># k = roundList(k, round_line_ind[&#39;drops&#39;])</span>
            <span class="n">a</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>

        <span class="n">a</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.printMatlog"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.printMatlog">[docs]</a>    <span class="k">def</span> <span class="nf">printMatlog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write matlogsets file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">matrDatabase</span><span class="p">[</span><span class="s1">&#39;matlog&#39;</span><span class="p">])</span>

        <span class="n">a</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setFile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">press</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">18</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vgg_median_bysets</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;matlogsets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                      <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;matlogsets&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">mm</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">200</span><span class="p">))</span>

            <span class="n">vgg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select vgg from results where Set1 = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">vgg_median_bysets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vgg</span><span class="p">)</span>

            <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span> <span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dglrms</span><span class="p">[</span><span class="n">it</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dgrrms</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;actualHeight&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">press</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="n">vgg</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">a</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;matlogsets&#39;</span><span class="p">]))</span>
            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">a</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.print_allanFile"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.print_allanFile">[docs]</a>    <span class="k">def</span> <span class="nf">print_allanFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method compute allan standard deviation of gTopCor, normres and grad.</span>
<span class="sd">        And also creates allan file and deviation and gradient graphs.</span>
<span class="sd">        tau is importing from CONFIG</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Compute allan standard deviation&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="c1"># Instance of allan file</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;allan&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                         <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;allan&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="c1"># Get data from database</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select gTopCor, Gradient from results where Accepted = 1&#39;</span><span class="p">)</span>
        <span class="n">gTopCor</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>
        <span class="n">grad</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">r</span><span class="p">]</span>

        <span class="c1"># print(self.normres)</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">allan</span><span class="p">(</span><span class="n">gTopCor</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
        <span class="c1"># np.savetxt(&#39;gTopCor.csv&#39;, gTopCor, delimiter = &#39;;&#39;)</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">allan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normres</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>
        <span class="n">a3</span> <span class="o">=</span> <span class="n">allan</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span>

        <span class="c1"># Printing to allan file</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">)):</span>
            <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">tau</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">a2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">a2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">a3</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">a3</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">file</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;allan&#39;</span><span class="p">]))</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Create graphs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allanGraph</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_allan_deviation&#39;</span><span class="p">,</span>
                            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;normalized data&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">allanGraph</span><span class="p">(</span><span class="n">a3</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_allan_gradient&#39;</span><span class="p">,</span>
                            <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;VGG&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.compute_normres"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.compute_normres">[docs]</a>    <span class="k">def</span> <span class="nf">compute_normres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute statistics for drops (standard deviations, mean errors, ...). Also call method print_allanFile, printMatlog.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Compute statistic by sets&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select max(Set1) from results&#39;</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select avg(gTopCor) from results where Accepted = 1 group by Set1&#39;</span><span class="p">)</span>

        <span class="c1"># r=[i[0] for i in r]</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># nset = (r)</span>
        <span class="c1"># self.nset = nset</span>

        <span class="n">ksmooth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;ksmooth&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stodch</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># mean error of sets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stdodchpadu</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># mean error of drops</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># weight of sets</span>
        <span class="n">gfinal</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># weight mean of g by sets</span>
        <span class="n">sumweight</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vv</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># mean correction</span>
        <span class="n">tst</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># what is this</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normres</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stodchmod</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stodchs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select gTopCor from results where Accepted = 1 and Set1 = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

            <span class="n">count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stodchs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
            <span class="n">stodchmod</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ksmooth</span> <span class="o">*</span> <span class="n">ksmooth</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stodchmod</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">stodchmod</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stdodchpadu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)))</span>
            <span class="c1"># print(&#39;STD {}&#39;.format(stdodchpadu[-1]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span> <span class="o">/</span> <span class="n">stodchmod</span><span class="p">)</span>
            <span class="n">sumweight</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">gfinal</span> <span class="o">+=</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">=</span> <span class="n">gfinal</span> <span class="o">/</span> <span class="n">sumweight</span>

        <span class="c1"># if nset&gt;1:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mm</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mm</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># print(weight[i])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mm</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># if count&gt;=1:</span>
        <span class="n">gstd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vv</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sumweight</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gstd</span> <span class="o">=</span> <span class="n">gstd</span>

        <span class="n">gtop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select gTopCor, Set1 from results where Accepted = 1&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gtop</span><span class="p">:</span>
            <span class="c1"># print((i[0]-self.gfinal)/stdodchpadu[i[1]-1]*gstd*np.sqrt(count))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">normres</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdodchpadu</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">gstd</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_allanFile</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">printMatlog</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.residuals_filter"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.residuals_filter">[docs]</a>    <span class="k">def</span> <span class="nf">residuals_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">grad</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method serves for filtering residuals by low pass filter implemented in scipy.signal.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        res : list</span>
<span class="sd">            mean resiudals</span>
<span class="sd">        grad : bool</span>
<span class="sd">            boolean value, True if residuals are from fits for gradient</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        yn</span>
<span class="sd">        resmmi</span>
<span class="sd">        tinc_filt</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># set kalpha for filtering residuals, 1.5*median of all m0</span>
        <span class="k">if</span> <span class="n">grad</span><span class="p">:</span>
            <span class="n">med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">m0grad</span><span class="p">)</span>
            <span class="n">kalpha</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kalpha</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">med</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">kalpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalpha_resid_rms</span>

        <span class="c1"># resample fringe</span>
        <span class="n">tinc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span><span class="p">)</span>
        <span class="c1"># interpolate residuals to resampled fringes</span>
        <span class="n">resyyy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">tinc</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="n">res</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">])</span>

        <span class="c1"># filter residuals with value &lt; kalpha</span>
        <span class="n">resyyy_filt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tinc_filt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resyyy</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">resyyy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">kalpha</span><span class="p">:</span>
                <span class="n">resyyy_filt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resyyy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">tinc_filt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tinc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># set filter of signal</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
        <span class="n">aa</span><span class="p">,</span> <span class="n">bb</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kcutoff</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
        <span class="n">yn</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">aa</span><span class="p">,</span> <span class="n">bb</span><span class="p">,</span> <span class="n">resyyy_filt</span><span class="p">)</span>

        <span class="c1"># reverse interpolating</span>
        <span class="n">resmmi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="n">tinc_filt</span><span class="p">,</span> <span class="n">yn</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">yn</span><span class="p">,</span> <span class="n">resmmi</span><span class="p">,</span> <span class="n">tinc_filt</span></div>

<div class="viewcode-block" id="Compute.set_kcutoff"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.set_kcutoff">[docs]</a>    <span class="k">def</span> <span class="nf">set_kcutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setting of frequency for signal filtering.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">coff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coff</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kcutoff</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">coff</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span></div>

<div class="viewcode-block" id="Compute.write_res_final"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.write_res_final">[docs]</a>    <span class="k">def</span> <span class="nf">write_res_final</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write residuals_final, residuals_sets, res_vgg and residuals_final1000 files.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">prescale</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span>
        <span class="c1"># it=0</span>

        <span class="c1"># self.FG5X[&#39;frmaxplot&#39;]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v0m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g0m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10e9</span>
        <span class="n">v0mg0mkor</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">v0m</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">g0m</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>

        <span class="c1"># self.tinc = np.linspace(self.tt[0], self.tt[self.frmaxplot], self.nforfft)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;residuals_final&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                      <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;residuals_final&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
        <span class="n">by_sets</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;residuals_sets&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;residuals_sets&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
        <span class="n">resgradsum</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;res_vgg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                               <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;res_vgg&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="n">a1000</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;residuals_final1000&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                          <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;residuals_final1000&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="c1"># =======================================================================</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_kcutoff</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">yn</span><span class="p">,</span> <span class="n">resmmi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tinc_filt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">grad</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># =======================================================================</span>
        <span class="n">_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resgradsm4filt</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># =======================================================================</span>

        <span class="c1"># data for round value to print into file</span>
        <span class="n">round_ind_bysets</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
        <span class="n">round_ind_bysets</span><span class="o">.</span><span class="n">extend</span><span class="p">([[</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">):</span>

            <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lambda</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="mf">1e-9</span> <span class="o">*</span> <span class="n">prescale</span>
            <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">v0mg0mkor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">it</span><span class="p">],</span> <span class="n">resmmi</span><span class="p">[</span><span class="n">it</span><span class="p">]]</span>
            <span class="n">a</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;residuals_final&#39;</span><span class="p">]))</span>

            <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">v0mg0mkor</span><span class="p">]</span>
            <span class="n">line</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[:,</span> <span class="n">it</span><span class="p">])</span>
            <span class="n">by_sets</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_ind_bysets</span><span class="p">))</span>

            <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">v0mg0mkor</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">it</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">resgradsm4filt</span><span class="p">[</span><span class="n">it</span><span class="p">]]</span>
            <span class="n">resgradsum</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;res_vgg&#39;</span><span class="p">]))</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">v0mg0mkor</span><span class="p">,</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">it</span> <span class="o">-</span> <span class="mi">4</span><span class="p">:</span><span class="n">it</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">resmmi</span><span class="p">[</span><span class="n">it</span><span class="p">]]</span>
                <span class="n">a1000</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;residuals_final1000&#39;</span><span class="p">]))</span>

        <span class="n">a</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">by_sets</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">resgradsum</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">a1000</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.reject_by_median_m0"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.reject_by_median_m0">[docs]</a>    <span class="k">def</span> <span class="nf">reject_by_median_m0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method filters drops by their m0.</span>
<span class="sd">        Each drop with m0 &gt; 1.5*median of all m0 is rejected.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Reject drops by their m0&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="c1"># Data from database</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select gTopCor, sqrt(m0), Set1, Drop1 from results&#39;</span><span class="p">)</span>

        <span class="c1"># Median of m0</span>
        <span class="n">resMed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">([</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>

        <span class="c1"># Drop acceptance limit</span>
        <span class="n">kalpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kalpha</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kalpha_resid_rms</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kalpha</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">resMed</span>

        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># grad4Acc = 0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="c1"># accepted if m0 &lt; 1.5*median m0</span>
            <span class="k">if</span> <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">kalpha_resid_rms</span><span class="p">:</span>
                <span class="n">update</span> <span class="o">=</span> <span class="n">matrDatabase</span><span class="p">[</span><span class="s1">&#39;updateAcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">j</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.rejectBySigma"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.rejectBySigma">[docs]</a>    <span class="k">def</span> <span class="nf">rejectBySigma</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reject drops by rejsigma.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Print to logWindow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Reject drops with rejsigma&gt;3*std&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="k">for</span> <span class="nb">set</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>

            <span class="c1"># iterative filtering by rejsigma, drop with the biggest difference from the average is rejected and the process is repeated until no drop is rejected</span>
            <span class="n">max_drop</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_drop</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">set_std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;select stdev(gTopCor) from results where Accepted = 1 and Set1 = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">set</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">set_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s1">&#39;select avg(gTopCor) from results where Accepted = 1 and Set1 = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">set</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">max_diff</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e10</span>
                <span class="n">max_drop</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="s1">&#39;select gTopCor, Set1, Drop1 from results where Set1 = </span><span class="si">{}</span><span class="s1"> and Accepted = 1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">set</span><span class="p">))):</span>

                    <span class="n">diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">set_mean</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rejsig</span> <span class="o">*</span> <span class="n">set_std</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="n">max_diff</span><span class="p">:</span>
                            <span class="n">max_diff</span> <span class="o">=</span> <span class="n">diff</span>
                            <span class="n">max_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_drop</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">update</span> <span class="o">=</span> <span class="n">matrDatabase</span><span class="p">[</span><span class="s1">&#39;updateAcc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">max_drop</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

        <span class="c1"># Variable for mean residuals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">])))</span>

        <span class="n">acc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select n from results where Accepted = 1&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">acc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resgradsum4Mean</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.meanResidualsBySets"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.meanResidualsBySets">[docs]</a>    <span class="k">def</span> <span class="nf">meanResidualsBySets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute mean residuals by sets.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Compute mean residuals by sets&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="c1"># initialization of arrays for averages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_fringes</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">))</span>
        <span class="c1"># get is drop accepted set values from database</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Accepted, Set1 from results&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">d</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;select count(*) from results</span>
<span class="s1">        where Accepted = 1</span>
<span class="s1">        group by Set1&#39;&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">c</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">allAcc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allAcc</span> <span class="o">+=</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">it</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># mean the residuals</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span><span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span><span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">allAcc</span></div>

<div class="viewcode-block" id="Compute.fft"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.fft">[docs]</a>    <span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tin</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">t_frmin_frmax</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">residuals</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method compute fft.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tin : list</span>
<span class="sd">            new interval</span>
<span class="sd">        t_frmin_frmax : list</span>
<span class="sd">            times of fringes</span>
<span class="sd">        residuals : list</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># transformation of residuals = f(t_frmin_frmax) =&gt; tin</span>
        <span class="n">resd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">tin</span><span class="p">,</span> <span class="n">t_frmin_frmax</span><span class="p">,</span> <span class="n">residuals</span><span class="p">)</span>
        <span class="n">resd</span> <span class="o">=</span> <span class="n">resd</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">resd</span><span class="p">)</span>

        <span class="c1"># fft</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">resd</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.fourier"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.fourier">[docs]</a>    <span class="k">def</span> <span class="nf">fourier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute fourier transformation for residuals: all res., mean res. by set and mean res.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Fourier transformation&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="c1"># split tt on nforfft parts</span>
        <span class="n">tin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span><span class="p">)</span>
        <span class="n">ttx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]</span>

        <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># arrays with results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yfda</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrops</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yfdMeanBySet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yfdMean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
        <span class="c1"># yfs = np.zeros((self.nset, self.nforfft), dtype=complex)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yfsa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>  <span class="c1"># by set</span>

        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># fourier transformation for all drops</span>
        <span class="k">for</span> <span class="n">ress</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allRes</span><span class="p">:</span>
            <span class="c1"># for accepted drops</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="n">it</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">ress</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]</span>

                <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">tin</span><span class="o">=</span><span class="n">tin</span><span class="p">,</span> <span class="n">t_frmin_frmax</span><span class="o">=</span><span class="n">ttx</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="n">res</span><span class="p">)</span>

                <span class="c1"># fft for all residuals</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yfda</span><span class="p">[</span><span class="n">it</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">)</span>

                <span class="nb">set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">[</span><span class="n">it</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

                <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">x</span><span class="p">])</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">[</span><span class="nb">set</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yfdMeanBySet</span><span class="p">[</span><span class="nb">set</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">l</span>

                <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">fft</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">x</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">allAcc</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yfdMean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># fourier transformation for mean residuals by set</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">):</span>
            <span class="c1"># ress = np.interp(tin, ttx, self.meanResSets[i, self.frmin - 1:self.frmax])</span>
            <span class="c1">#</span>
            <span class="c1"># ressm = ress - np.mean(ress)</span>
            <span class="c1">#</span>
            <span class="c1"># fft = 2 / self.nforfft * np.fft.fft(ressm)</span>

            <span class="n">fft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">tin</span><span class="o">=</span><span class="n">tin</span><span class="p">,</span> <span class="n">t_frmin_frmax</span><span class="o">=</span><span class="n">ttx</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">yfsa</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">[:</span><span class="n">x</span><span class="p">])</span>

        <span class="c1"># spectrum for mean all residuals</span>
        <span class="c1"># resf = np.interp(tin, ttx, self.meanRes[0, self.frmin - 1:self.frmax])</span>
        <span class="c1"># resfm = resf - np.mean(resf)</span>
        <span class="c1"># yff = 2 / self.nforfft * np.fft.fft(resfm)</span>

        <span class="n">yff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">tin</span><span class="o">=</span><span class="n">tin</span><span class="p">,</span> <span class="n">t_frmin_frmax</span><span class="o">=</span><span class="n">ttx</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">meanRes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yffa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">yff</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">x</span><span class="p">]))</span>

        <span class="c1"># writing data to text files</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="c1"># create vector of frequencies for printing output file</span>
            <span class="n">fs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">tin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tin</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">frk</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">fs</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">frk</span><span class="p">)</span>

            <span class="c1"># np.savetxt()</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                          <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nforfft</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)):</span>
                <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">yffa</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfdMean</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]]</span>
                <span class="n">a</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;spectrum&#39;</span><span class="p">]))</span>

            <span class="n">a</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.print_avr_residuals_spectrum"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.print_avr_residuals_spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">print_avr_residuals_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write set_spectrum_avr_res file.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;Frequency&#39;</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">):</span>
            <span class="n">header</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">Set </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">avr_res</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;set_spectrum_avr_res&#39;</span><span class="p">,</span>
                            <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="n">avr_spec</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
                             <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;set_spectrum_avr_spec&#39;</span><span class="p">,</span>
                             <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fr</span><span class="p">)):</span>
            <span class="n">line_res</span> <span class="o">=</span> <span class="n">line_spec</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">):</span>
                <span class="n">line_res</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{}{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfsa</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>

                <span class="n">line_spec</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">{}{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yfdMeanBySet</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>

            <span class="n">avr_res</span><span class="o">.</span><span class="n">write_line</span><span class="p">(</span><span class="n">line_res</span><span class="p">)</span>

            <span class="n">avr_spec</span><span class="o">.</span><span class="n">write_line</span><span class="p">(</span><span class="n">line_spec</span><span class="p">)</span>

        <span class="n">avr_res</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">avr_spec</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.sensitivity"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.sensitivity">[docs]</a>    <span class="k">def</span> <span class="nf">sensitivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute sensitivity.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Compute sensitivity&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="c1"># initialization of arrays for sensitivity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_tx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_tn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dglm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_tx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_tn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgrm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

        <span class="c1"># sensitivity is calculated for averages by sets</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sens_tn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_tx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># data for fitting by parabola on left side of drop</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span><span class="p">]</span>
                <span class="c1"># fitting by parabola</span>
                <span class="n">koef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1"># storing quadratic coefficient of equation of fitted parabola</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dgl</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">koef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># data for fitting by parabola on right side of drop</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                <span class="c1"># fitting by parabola</span>
                <span class="n">koef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1"># storing quadratic coefficient of equation of fitted parabola</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dgr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span><span class="p">]</span> <span class="o">=</span> <span class="n">koef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dglm</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgl</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dgrm</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c1"># average</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dglm</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgrm</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span>
        <span class="c1"># np.savetxt(&#39;dgr.csv&#39;, self.dgr, delimiter=&#39;;&#39;)</span>
        <span class="c1"># np.savetxt(&#39;dgrm.csv&#39;, self.dgrm, delimiter=&#39;;&#39;)</span>
        <span class="c1"># ==============================================================================</span>

        <span class="n">rozd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_tn</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_tn</span>
        <span class="n">celk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_tx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_tn</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dglc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgl</span><span class="p">[:,</span> <span class="n">rozd</span><span class="p">:</span><span class="n">rozd</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">celk</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dglrms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dglc</span><span class="o">.</span><span class="n">transpose</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">celk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># ==============================================================================</span>
        <span class="n">rozd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_bn</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span>
        <span class="n">celk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_bx</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensa_bn</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dgrc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgr</span><span class="p">[:,</span> <span class="n">rozd</span><span class="p">:</span><span class="n">rozd</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">celk</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dgrrms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgrc</span><span class="o">.</span><span class="n">transpose</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">celk</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span></div>
        <span class="c1"># ==============================================================================</span>

<div class="viewcode-block" id="Compute.sensitivity_time"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.sensitivity_time">[docs]</a>    <span class="k">def</span> <span class="nf">sensitivity_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute sensitivity in time.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Compute sensitivity - time&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># step for faster computing of sensitivity</span>
        <span class="n">ttlinmin</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="mi">10000</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">10000</span>
        <span class="n">ttlinmax</span> <span class="o">=</span> <span class="n">floor</span><span class="p">(</span><span class="mi">10000</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">10000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ttlinmin</span><span class="p">,</span> <span class="n">ttlinmax</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">)</span>
        <span class="n">nttlin</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">)</span>
        <span class="n">tfrmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">tfrmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmax</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">indsenstn</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">indsenstx</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">indsensbn</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">indsensbx</span> <span class="o">=</span> <span class="n">nttlin</span>
        <span class="n">indsensfrmin</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">indsensfrmax</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nttlin</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
                <span class="n">indsenstn</span> <span class="o">=</span> <span class="n">i</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sens_tx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
                <span class="n">indsenstx</span> <span class="o">=</span> <span class="n">i</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sens_bn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
                <span class="n">indsensbn</span> <span class="o">=</span> <span class="n">i</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sens_bx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ttlinmax</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
                <span class="n">indsensbx</span> <span class="o">=</span> <span class="n">i</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">tfrmin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
                <span class="n">indsensfrmin</span> <span class="o">=</span> <span class="n">i</span>

            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">tfrmax</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">:</span>
                <span class="n">indsensfrmax</span> <span class="o">=</span> <span class="n">i</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">indsensfrmax</span> <span class="o">=</span> <span class="n">indsensfrmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indsensfrmin</span> <span class="o">=</span> <span class="n">indsensfrmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indsenstx</span> <span class="o">=</span> <span class="n">indsenstx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indsenstn</span> <span class="o">=</span> <span class="n">indsenstn</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indsensbn</span> <span class="o">=</span> <span class="n">indsensbn</span>

        <span class="c1"># initialization of arrays for sensitivity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dglt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">indsenstn</span><span class="p">,</span> <span class="n">indsenstx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgrt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">indsensbn</span><span class="p">,</span> <span class="n">indsensbx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">))))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dgltm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">indsenstn</span><span class="p">,</span> <span class="n">indsenstx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgrtm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">indsensbn</span><span class="p">,</span> <span class="n">indsensbx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">))))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ttr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ttttlin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">indsensbn</span><span class="p">:</span> <span class="n">indsensbx</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tttlin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">indsenstn</span><span class="p">:</span> <span class="n">indsenstx</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tttt_plot</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ttttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttttlin</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tttt_indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)]</span>

        <span class="c1"># sensitivity is calculated for averages by sets</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">):</span>

            <span class="n">ttr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tt</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">meanResSets</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxplot</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ttr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ttr</span>
            <span class="n">bleble</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">ble</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">indj</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indsenstn</span><span class="p">,</span> <span class="n">indsenstx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">):</span>
                <span class="c1"># data for fitting by parabola on left side of drop</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">indsensfrmax</span><span class="p">]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">ttr</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">indsensfrmax</span><span class="p">]</span>
                <span class="n">bleble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="c1"># fitting by parabola</span>
                <span class="n">koef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1"># storing quadratic coefficient of equation of fitted parabola</span>
                <span class="c1"># self.dglt[i, j - indsenstn] = koef[0] * 2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dglt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">indj</span><span class="p">]</span> <span class="o">=</span> <span class="n">koef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
                <span class="n">indj</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">indj</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">indsensbn</span><span class="p">,</span> <span class="n">indsensbx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">):</span>
                <span class="c1"># data for fitting by parabola on right side of drop</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">indsensfrmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">ttr</span><span class="p">[</span><span class="n">indsensfrmin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">ble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="c1"># fitting by parabola</span>
                <span class="n">koef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="c1"># storing quadratic coefficient of equation of fitted parabola</span>
                <span class="c1"># self.dgrt[i, j - indsensbn] = koef[0] * 2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dgrt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">indj</span><span class="p">]</span> <span class="o">=</span> <span class="n">koef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
                <span class="n">indj</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">dgltm</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dglt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dgrtm</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgrt</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c1"># average</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgltm</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dgrtm</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span></div>

        <span class="c1"># np.savetxt(&#39;dgltm.csv&#39;, self.dgltm, delimiter=&#39;;&#39;)</span>
        <span class="c1"># np.savetxt(&#39;dgrtm.csv&#39;, self.dgrtm, delimiter=&#39;;&#39;)</span>

<div class="viewcode-block" id="Compute.Graph_EffHeight_CorToEffHeight"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.Graph_EffHeight_CorToEffHeight">[docs]</a>    <span class="k">def</span> <span class="nf">Graph_EffHeight_CorToEffHeight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write effective_height_corr file.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        project : str</span>
<span class="sd">            name of campaign</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get data from database</span>
        <span class="n">res1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select EffHeight, CorToEffHeight from results&#39;</span><span class="p">)</span>
        <span class="c1"># Open result file</span>
        <span class="c1"># file=open(self.projDirPath+&#39;/Graphs/&#39;+project+&#39;_&#39;+&#39;effective_height_corr.csv&#39;, &#39;w&#39;)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="n">res_final</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;effective_height_corr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">),</span>
                         <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;effective_height_corr&#39;</span><span class="p">,</span>
                         <span class="n">delimiter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">delimiter</span><span class="p">)</span>

        <span class="c1"># Create lists print graph and print lines of result file</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">res2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res1</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">res2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res1</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">file</span><span class="o">.</span><span class="n">printResult</span><span class="p">(</span><span class="n">line</span><span class="o">=</span><span class="n">roundList</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">round_line_ind</span><span class="p">[</span><span class="s1">&#39;effHeightCorr_Graph&#39;</span><span class="p">]))</span>

        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="c1"># Print graph</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">data1</span> <span class="o">=</span> <span class="n">res</span>
        <span class="n">data2</span> <span class="o">=</span> <span class="n">res2</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;effective_height&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;effective_height&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;effective_height&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">data1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same x-axis</span>

        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;effective_height&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel2&#39;</span><span class="p">],</span>
                       <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># we already handled the x-label with ax1</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># otherwise the right y-label is slightly clipped</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="s1">&#39;effective_height.png&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.parasitic_wave"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.parasitic_wave">[docs]</a>    <span class="k">def</span> <span class="nf">parasitic_wave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute amplitude and phase of the parasitic wave.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Compute amplitude and phase of the parasitic wave&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="c1"># Get data from database</span>
        <span class="n">e_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select e_withGR, f_withGR from results&#39;</span><span class="p">)</span>

        <span class="c1"># Calc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ampar</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># amplitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fazepar</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># phase</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_f</span><span class="p">)):</span>
            <span class="n">ampar</span> <span class="o">=</span> <span class="n">e_f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">e_f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">e_f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">e_f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ampar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ampar</span><span class="p">))</span>

            <span class="n">fazepar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">e_f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">e_f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fazepar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fazepar</span><span class="p">)</span>

        <span class="n">fazepar2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">e_f</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span><span class="p">):</span>
            <span class="k">if</span> <span class="mi">9</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">e_f</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">:</span>
                <span class="n">fazepar2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fazepar</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">10</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fazepar2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fazefilt</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># average of phases</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">e_f</span><span class="p">)</span> <span class="o">+</span> <span class="mi">11</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fazefilt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">fazepar2</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">11</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">10</span><span class="p">])</span> <span class="o">/</span> <span class="mi">21</span><span class="p">)</span></div>

<div class="viewcode-block" id="Compute.graph_parasitic2"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graph_parasitic2">[docs]</a>    <span class="k">def</span> <span class="nf">graph_parasitic2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create subplot graph from results from &quot;parasitic_wave&quot; method</span>
<span class="sd">        1) Amplitude</span>
<span class="sd">        2) Phase</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ampar</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># xrange for graphs</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ampar</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic2&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;Lpar&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e10</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic2&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic2&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel1&#39;</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ampar</span><span class="p">))])</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fazepar</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fazefilt</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic2&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">])</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;parasitic2&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel2&#39;</span><span class="p">])</span>

        <span class="c1"># save graph</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;parasitic2&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graph_sensitivity_top"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graph_sensitivity_top">[docs]</a>    <span class="k">def</span> <span class="nf">graph_sensitivity_top</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of sensitivity on the top of drop.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">]</span>
        <span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
        <span class="c1"># legend = []</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span>

        <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dgl</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgl</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
            <span class="c1"># legend.append(&#39;{} {}&#39;.format(self.graph_lang[&#39;sensitivity_top&#39;][&#39;set_description&#39;], i + 1))</span>

        <span class="c1"># legend.append(self.graph_lang[&#39;sensitivity_top&#39;][&#39;legend&#39;])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dglm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_top&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_top&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_top&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
        <span class="c1"># p.legend(legend)</span>

        <span class="c1"># save graph</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sensitivity_top&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.graph_sensitivity_top_time"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.graph_sensitivity_top_time">[docs]</a>    <span class="k">def</span> <span class="nf">graph_sensitivity_top_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Graph of sensitivity in time on the top of drop.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">frmin</span><span class="p">]</span>
        <span class="c1"># ylim = [-20, 20]</span>
        <span class="c1"># legend = []</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span>

        <span class="c1"># x = self.ttlin[self]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indsenstn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indsenstx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)]</span>

        <span class="c1"># for i in range(self.dglt.shape[0]):</span>
        <span class="c1">#     p.plot(x, self.dglt[i, :], lw=0.7)</span>
        <span class="c1">#     legend.append(&#39;{} {}&#39;.format(self.graph_lang[&#39;sensitivity_top_time&#39;][&#39;set_description&#39;], i + 1))</span>

        <span class="c1"># legend.append(self.graph_lang[&#39;sensitivity_top_time&#39;][&#39;legend&#39;])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dgltm</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># p.plot([xlim[0], xlim[0]], [ylim[0], ylim[1]], &#39;b&#39;, lw=0.9)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">indsensfrmin</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ttlin</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">indsensfrmin</span><span class="p">]],</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_top_time&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_top_time&#39;</span><span class="p">][</span><span class="s1">&#39;xlabel&#39;</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph_lang</span><span class="p">[</span><span class="s1">&#39;sensitivity_top_time&#39;</span><span class="p">][</span><span class="s1">&#39;ylabel&#39;</span><span class="p">])</span>
        <span class="n">p</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
        <span class="c1"># p.legend(legend)</span>

        <span class="c1"># save graph</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Graphs/&#39;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;sensitivity_top_time&#39;</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span>
        <span class="n">p</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">project</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.print_results_dat"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.print_results_dat">[docs]</a>    <span class="k">def</span> <span class="nf">print_results_dat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method generates results.dat file, sources for the file are in  &quot;results_dat&quot; folder.</span>
<span class="sd">        The folder contains two files (results_dat_part1.txt, results_dat_part3.txt).</span>
<span class="sd">        The first part contains content for part from start to table with mean by sets including head of the table.</span>
<span class="sd">        The third part contains content from end of the table to end of file.</span>
<span class="sd">        The second part is generated in this method from database.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># path of the file</span>
        <span class="n">part1_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="s1">&#39;results_dat&#39;</span><span class="p">,</span> <span class="s1">&#39;results_dat_part1.txt&#39;</span><span class="p">)</span>
        <span class="n">part3_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">script_path</span><span class="p">,</span> <span class="s1">&#39;results_dat&#39;</span><span class="p">,</span> <span class="s1">&#39;results_dat_part3.txt&#39;</span><span class="p">)</span>

        <span class="c1"># load first part of the file</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">part1_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">part1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># get data from databse to the file</span>
        <span class="n">sets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;select Set1, substr(Date,0,5), substr(Date,6,2), substr(Date,9,2), substr(Date,12,2), substr(Date,15,2), substr(Date, 18, 2), count(*), round(avg(gTopCor),2), round(avg(Tide),2), round(avg(Polar),2), round(avg(Baro),2), round(avg(CorrToTop),2)  from results  where Accepted = 1 group by Set1&#39;</span><span class="p">)</span>

        <span class="c1"># creare list with data to the file</span>
        <span class="n">part1_fill</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># agdas version</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">])</span>  <span class="c1"># project name</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>  <span class="c1"># station</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;SiteCode&#39;</span><span class="p">])</span>  <span class="c1"># site code</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>  <span class="c1"># lat</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;long&#39;</span><span class="p">])</span>  <span class="c1"># long</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;elev&#39;</span><span class="p">])</span>  <span class="c1"># elev</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># gradient</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;setupHeight&#39;</span><span class="p">])</span>  <span class="c1"># setup height</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;transferHeight&#39;</span><span class="p">])</span>  <span class="c1"># transfer height</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;airPressure&#39;</span><span class="p">])</span>  <span class="c1"># nominal air pressure</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;barometricFactor&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># Barometric Admittance Factor</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_pole_interp</span><span class="p">)))</span>  <span class="c1"># polar x</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;polarX&#39;</span><span class="p">]))</span>  <span class="c1"># polar x</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_pole_interp</span><span class="p">)))</span>  <span class="c1"># polar y</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;polarY&#39;</span><span class="p">]))</span>  <span class="c1"># polar y</span>

        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select avg(mjd) from results&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># mean mjd</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">useIERSPoleCorr</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>  <span class="c1"># polar coord service</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">polar_file_date</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">())</span>  <span class="c1"># date of downloading polar coordinates</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Project file&#39;</span><span class="p">)</span>
            <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rubi_freq</span><span class="p">))</span>  <span class="c1"># Rubidium Frequency</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">])</span>  <span class="c1"># laser wavelengths</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;IE&#39;</span><span class="p">])</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;IF&#39;</span><span class="p">])</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instrumentData</span><span class="p">[</span><span class="s1">&#39;IG&#39;</span><span class="p">])</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmodf</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># modulation frequency</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lpar</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># Parasitic wavelength</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lcable_ar</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># TTL Cable length</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">)</span>  <span class="c1"># Number of Sets Processed</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ndrops</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">nset</span><span class="p">))</span>  <span class="c1"># Number of Drops/Set</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;totalFringes&#39;</span><span class="p">])</span>  <span class="c1"># Total Fringes Acquired</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;multiplex&#39;</span><span class="p">])</span>  <span class="c1"># GuideCard Multiplex</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processingResults</span><span class="p">[</span><span class="s1">&#39;scaleFactor&#39;</span><span class="p">])</span>  <span class="c1"># GuideCard Scale Factor</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frminT</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># First FRINGE</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frmaxT</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># Final FRINGE</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kalpha</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># STD threshold for drop acceptance</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rejsigma</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>  <span class="c1"># Coverage factor for drop gravity acceptance</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">95</span><span class="p">)</span>  <span class="c1"># Confidence level for set gravities</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gravimeter</span><span class="p">[</span><span class="s1">&#39;ksmooth&#39;</span><span class="p">])</span>  <span class="c1"># STD for set gravity systematic effects</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ksol</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>  <span class="c1"># Speed of light</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ksae</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>  <span class="c1"># Self-attration</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kdis</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>  <span class="c1"># Dispersion in TTL cable</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kimp</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>  <span class="c1"># Impedance mismatch</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kpar</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>  <span class="c1"># Parasitic wave</span>
        <span class="n">part1_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;actualHeight&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span>  <span class="c1"># TOP OF THE DROP</span>

        <span class="n">part1</span> <span class="o">=</span> <span class="n">part1</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">part1_fill</span><span class="p">)</span>

        <span class="n">l</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">  </span><span class="si">{}</span><span class="s1">  </span><span class="si">{}</span><span class="s1">  </span><span class="si">{}</span><span class="s1">   </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">    </span><span class="si">{}</span><span class="s1">    </span><span class="si">{}</span><span class="s1">    </span><span class="si">{}</span><span class="s1">   </span><span class="si">{}</span><span class="s1">  </span><span class="si">{}</span><span class="s1">   </span><span class="si">{}</span><span class="s1">    </span><span class="si">{}</span><span class="s1">     </span><span class="si">{}</span><span class="s1">&#39;</span>
        <span class="n">part2</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">it</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sets</span><span class="p">:</span>
            <span class="n">l_</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stodch</span><span class="p">[</span><span class="n">it</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
            <span class="n">l_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tst</span><span class="p">[</span><span class="n">it</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">))</span>

            <span class="n">part2</span> <span class="o">+=</span> <span class="n">l</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">l_</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">it</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">part3_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">part3</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_count_gradients</span><span class="p">()</span>
        <span class="n">part3_fill</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">drops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select max(n) from results&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drops</span><span class="p">)</span>  <span class="c1"># measured drops</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select count(*) from results where Accepted = 1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># accepted drops</span>
        <span class="n">mjd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select avg(mjd) from results&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">jd</span> <span class="o">=</span> <span class="n">mjd_to_jd</span><span class="p">(</span><span class="n">mjd</span><span class="p">)</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">jd_to_date</span><span class="p">(</span><span class="n">jd</span><span class="p">)</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">date</span><span class="p">))</span>  <span class="c1"># date</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span><span class="p">))</span>  <span class="c1"># final g</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gstd</span><span class="p">))</span>  <span class="c1"># std of final g</span>
        <span class="n">hefm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select avg(EffHeight + CorToEffHeight) from &#39;</span>
                                        <span class="s1">&#39;results where Accepted = 1&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hefm</span><span class="p">))</span>  <span class="c1"># EFFECTIVE INSTRUMENTAL HEIGHT from  top of the drop</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select EffHeight + CorToEffHeight from results where Accepted = 1&#39;</span><span class="p">),</span>
                   <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>  <span class="c1"># STD OF EFFECTIVE INSTRUMENTAL HEIGHT from  top of the drop</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;actualHeight&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">hefm</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">))</span>  <span class="c1"># EFFECTIVE INSTRUMENTAL HEIGHT</span>
        <span class="n">grefer</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="n">hefm</span><span class="p">)</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grefer</span><span class="p">)</span>  <span class="c1"># g @ EFFECTIVE INSTRUMENTAL HEIGHT</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">])</span>  <span class="c1"># Vertical gravity gradient</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.5f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;transferHeight&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span>  <span class="c1"># DATUM HEIGHT</span>
        <span class="n">g00</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gfinal</span> <span class="o">-</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;gradient&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;actualHeight&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gravityCorrections</span><span class="p">[</span><span class="s1">&#39;transferHeightGal&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e9</span>  <span class="c1"># g @ DATUM HEIGHT</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g00</span><span class="p">))</span>  <span class="c1"># g @ DATUM HEIGHT</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Press</span><span class="p">)))</span>  <span class="c1"># AIR PRESSURE</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Press</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Press</span><span class="p">)))</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="p">)))</span>  <span class="c1"># tides</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tides</span><span class="p">)))</span>
        <span class="n">vgg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matr_connection</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;select Gradient from results&#39;</span><span class="p">)</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vgg</span><span class="p">)))</span>  <span class="c1"># Estimated gravity gradient</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">vgg</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">drops</span><span class="p">))</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vggp3_</span><span class="p">))</span>  <span class="c1"># Estimated gravity gradient after removing outliers</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mggp3_</span> <span class="o">/</span> <span class="n">outliers</span><span class="p">))</span>
        <span class="n">part3_fill</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">drops</span> <span class="o">-</span> <span class="n">outliers</span><span class="p">)</span>  <span class="c1"># outliers</span>

        <span class="n">part3</span> <span class="o">=</span> <span class="n">part3</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">part3_fill</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">projDirPath</span> <span class="o">+</span> <span class="s1">&#39;/Files/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stationData</span><span class="p">[</span><span class="s1">&#39;ProjName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_results.dat&#39;</span>
        <span class="n">e</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">part1</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">part2</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">part3</span><span class="p">)</span>
        <span class="n">e</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Compute.end"><a class="viewcode-back" href="../../Agdas.html#Agdas.compute.Compute.end">[docs]</a>    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">separator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logWindow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Done&#39;</span><span class="p">)</span>
        <span class="c1"># self.logWindow.append(&#39;Time of run computing: {} s&#39;.format(round(time()-t)))</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">compute</span> <span class="o">=</span> <span class="n">Compute</span><span class="p">()</span>
    <span class="n">compute</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="c1"># def harmonic(self):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     Effect of harmonica on VGG a change g</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     Lmin = self.FG5X[&#39;Lmin&#39;]</span>
<span class="c1">#     Lmax = self.FG5X[&#39;Lmax&#39;]</span>
<span class="c1">#     frmin=self.FG5X[&#39;frmin&#39;] #start fringe</span>
<span class="c1">#     frmax=self.FG5X[&#39;frmax&#39;] #final fringe</span>
<span class="c1">#     frmaxplot = self.FG5X[&#39;frmaxplot&#39;] #range of data</span>
<span class="c1">#     hefm = self.matr_connection.get(&#39;select avg(EffHeight + CorToEffHeight) from results where Accepted = 1&#39;)</span>
<span class="c1">#     hefm = hefm[0][0]</span>
<span class="c1">#     gamma = float(self.stationData[&#39;gradient&#39;]) #Gradient from file</span>
<span class="c1">#     nset = self.nset</span>
<span class="c1">#     # self.v0m=np.median(self.v0)/1e3</span>
<span class="c1">#     # self.g0m=np.median(self.g0)/10e9</span>
<span class="c1">#</span>
<span class="c1">#     # tfit = np.loadtxt(&#39;tfit.csv&#39;, delimiter = &#39;;&#39;)</span>
<span class="c1">#     tfit = self.meanResSets[1,:]</span>
<span class="c1">#</span>
<span class="c1">#     ressets2 = np.zeros((frmaxplot, nset))</span>
<span class="c1">#     A0 = np.ndarray((frmax-frmin+1, 3))</span>
<span class="c1">#     AH = np.ndarray((frmax-frmin+1, 3))</span>
<span class="c1">#     AL1 = np.ndarray((frmax-frmin+1, 3))</span>
<span class="c1">#     LA = np.ndarray((frmax-frmin+1, 3))</span>
<span class="c1">#     harmonic_res = np.ndarray((10*Lmax-10*Lmin+1, nset))</span>
<span class="c1">#     T0_m = np.ndarray((10*Lmax-10*Lmin+1, nset))</span>
<span class="c1">#     A0_m = np.ndarray((10*Lmax-10*Lmin+1, nset))</span>
<span class="c1">#     B0_m = np.ndarray((10*Lmax-10*Lmin+1, nset))</span>
<span class="c1">#</span>
<span class="c1">#     xg=[]</span>
<span class="c1">#     xvgg=[]</span>
<span class="c1">#     mx0=[]</span>
<span class="c1">#     mxL1=[]</span>
<span class="c1">#     dg=[]</span>
<span class="c1">#     mdg=[]</span>
<span class="c1">#     vgg=[]</span>
<span class="c1">#     mvgg=[]</span>
<span class="c1">#     # minimum_index_array = []</span>
<span class="c1">#     # minimum_array=[]</span>
<span class="c1">#     LLmin=[] #wave lengths m</span>
<span class="c1">#     T0min=[] #zeros member</span>
<span class="c1">#     A0min=[] #cosinus member</span>
<span class="c1">#     B0min=[] #sinus member</span>
<span class="c1">#     harm_amp=[] #amplitude of harmonic</span>
<span class="c1">#     harm_phase=[] #phase of harmonic</span>
<span class="c1">#     t=time()</span>
<span class="c1">#     for n in range(nset):</span>
<span class="c1">#</span>
<span class="c1">#         #==========================================================#</span>
<span class="c1">#         A0[:, 0] = 1</span>
<span class="c1">#         A0[:, 1] = tfit[frmin-1: frmax]</span>
<span class="c1">#         A0[:, 2] = 0.5*tfit[frmin-1: frmax]*tfit[frmin-1: frmax]</span>
<span class="c1">#         b0=self.meanResSets[n, frmin-1:frmax]*1e-9</span>
<span class="c1">#</span>
<span class="c1">#         x, covar, m02, std, stdX, res, m0=Fall.computeLST(A0, b0, frmin-1, frmax)</span>
<span class="c1">#         mx0.append(m0*1e8)</span>
<span class="c1">#         xg.append(x[0][2])</span>
<span class="c1">#         #==========================================================#</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#         ressets2[:, n] = (self.meanResSets[n, :frmaxplot] - x[0][0] - x[0][1]*tfit[:frmaxplot] - 0.5*xg[n]*tfit[:frmaxplot]*tfit[:frmaxplot])*1e-9</span>
<span class="c1">#</span>
<span class="c1">#         #==========================================================#</span>
<span class="c1">#</span>
<span class="c1">#         AL1[:, 0] = 1</span>
<span class="c1">#         AL1[:, 1] = tfit[frmin-1: frmax]</span>
<span class="c1">#         AL1[:, 2] = self.v0m_bysets[n]/6*tfit[frmin-1: frmax]**3 + self.g0m_bysets[n]/24*tfit[frmin-1: frmax]**4 - hefm/2*tfit[frmin-1: frmax]*tfit[frmin-1: frmax] - hefm*gamma/24*tfit[frmin-1: frmax]**4</span>
<span class="c1">#         bL1 = ressets2[frmin-1:frmax, n]</span>
<span class="c1">#</span>
<span class="c1">#         x1, covar, m02, std, stdX, res, m0=Fall.computeLST(AL1, bL1, frmin-1, frmax)</span>
<span class="c1">#         xvgg.append((gamma + x1[0][2])*1e6)</span>
<span class="c1">#         mxL1.append(m0*1e6)</span>
<span class="c1">#         #==========================================================#</span>
<span class="c1">#</span>
<span class="c1">#         #calculating residuals and their std in range 3-16 cm</span>
<span class="c1">#         LLL=[]</span>
<span class="c1">#         for i in range(10*Lmin, 10*Lmax+1):</span>
<span class="c1">#             LL=i/1000</span>
<span class="c1">#             LLL.append(LL)</span>
<span class="c1">#</span>
<span class="c1">#             LA[:, 0] = 1</span>
<span class="c1">#             LA[:, 1] = np.sin(2*np.pi*self.zzh[frmin-1: frmax, n]/LL)</span>
<span class="c1">#             LA[:, 2] = np.cos(2*np.pi*self.zzh[frmin-1: frmax, n]/LL)</span>
<span class="c1">#</span>
<span class="c1">#             b = ressets2[frmin-1: frmax, n]</span>
<span class="c1">#</span>
<span class="c1">#             x2, covar, m02, std, stdX, res, m0=Fall.computeLST(LA, b, frmin-1, frmax)</span>
<span class="c1">#</span>
<span class="c1">#             T0_m[i-10*Lmin, n] = x2[0][0]*1e9</span>
<span class="c1">#             A0_m[i-10*Lmin, n] = x2[0][1]*1e9</span>
<span class="c1">#             B0_m[i-10*Lmin, n] = x2[0][2]*1e9</span>
<span class="c1">#             harmonic_res[i-10*Lmin, n] = np.std(res)*1e9</span>
<span class="c1">#</span>
<span class="c1">#         #searching of minimal residuals std</span>
<span class="c1">#         minimum = min(harmonic_res[:, n])</span>
<span class="c1">#         minimum_index = np.argmin(harmonic_res[:, n])</span>
<span class="c1">#</span>
<span class="c1">#         T0min.append(T0_m[minimum_index, n])</span>
<span class="c1">#         A0min.append(A0_m[minimum_index, n])</span>
<span class="c1">#         B0min.append(B0_m[minimum_index, n])</span>
<span class="c1">#         LLmin.append(Lmin/100 - 0.001 + minimum_index/1000)</span>
<span class="c1">#         # print(B0_m[minimum_index, n])</span>
<span class="c1">#</span>
<span class="c1">#         amplitude = np.sqrt(A0min[-1]*A0min[-1] + B0min[-1]*B0min[-1])</span>
<span class="c1">#         harm_amp.append(amplitude)</span>
<span class="c1">#</span>
<span class="c1">#         phase = np.arctan2(B0min[-1], A0min[-1])*(180/np.pi)</span>
<span class="c1">#         if phase &lt; 0:</span>
<span class="c1">#             harm_phase.append(phase + 360)</span>
<span class="c1">#         else:</span>
<span class="c1">#             harm_phase.append(phase)</span>
<span class="c1">#</span>
<span class="c1">#         #==========================================================#</span>
<span class="c1">#</span>
<span class="c1">#         bH = ressets2[frmin-1:frmax, n] - (T0min[n] - A0min[n]*np.sin(2*np.pi*self.zzh[frmin-1:frmax, n]/LLmin[n]) - B0min[n]*np.cos(2*np.pi*self.zzh[frmin-1:frmax, n]/LLmin[n]))/1e9</span>
<span class="c1">#         x1, covar, m02, std, stdX, res, m0=Fall.computeLST(A0, bH, frmin-1, frmax)</span>
<span class="c1">#         dg.append(x1[0][2]*1e8)</span>
<span class="c1">#         mdg.append(m0*1e8)</span>
<span class="c1">#</span>
<span class="c1">#         #==========================================================#</span>
<span class="c1">#         x1, covar, m02, std, stdX, res, m0=Fall.computeLST(AL1, res, frmin-1, frmax)</span>
<span class="c1">#         vgg.append((gamma + x1[0][2])*1e6)</span>
<span class="c1">#         mvgg.append(m0*1e6)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#     if self.files.isChecked():</span>
<span class="c1">#</span>
<span class="c1">#         a=res_final(path=self.projDirPath, header=headers[&#39;vgg_per_sets0&#39;].format(self.delimiter), name=self.stationData[&#39;ProjName&#39;]+&#39;_&#39;+&#39;vgg_per_sets0&#39;, delimiter = self.delimiter)</span>
<span class="c1">#         for i in range(len(xvgg)):</span>
<span class="c1">#             line=[i+1, xvgg[i], mxL1[i], xg[i]*1e8, mx0[i]]</span>
<span class="c1">#</span>
<span class="c1">#             a.printResult(line = roundList(line, round_line_ind[&#39;vgg_per_sets0&#39;]))</span>
<span class="c1">#</span>
<span class="c1">#         a.close()</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#         a=res_final(path=self.projDirPath, header=False, name=self.stationData[&#39;ProjName&#39;]+&#39;_&#39;+&#39;ressets_per&#39;, delimiter = self.delimiter)</span>
<span class="c1">#         for j in range(self.FG5X[&#39;frmaxplot&#39;]):</span>
<span class="c1">#             line=[j+1, tfit[j], tfit[j]-self.tkor[0], self.zzh[j,0]]</span>
<span class="c1">#</span>
<span class="c1">#             line1=[]</span>
<span class="c1">#             for n in range(nset):</span>
<span class="c1">#                 ll = ressets2[j,n]*1e9-T0min[n]-A0min[n]*np.sin(2*n.pi*self.zzh[i,n]/LLmin[n])-B0min[n]*np.cos(2*n.pi*self.zzh[j,n]/LLmin[n])</span>
<span class="c1">#                 line1.append(ll)</span>
<span class="c1">#</span>
<span class="c1">#             line.extend(line1)</span>
<span class="c1">#</span>
<span class="c1">#             a.printResult(line = line)</span>
<span class="c1">#</span>
<span class="c1">#         a.close()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Jakub Simek.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>